"use strict";(self.webpackChunkhcmd_communication=self.webpackChunkhcmd_communication||[]).push([[20],{35020:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Aa});var i=t(65043),l=t(34348),n=t.n(l),o=t(2364),d=t(31899),s=t.n(d),r=t(8738),c=t(73216),u=t(14282),p=t(9283),m=t(75314),v=t(43984),h=t(8006),f=t(9447),g=t(10611),y=t(31507),x=t(49911),b=t(46588),N=t(24461),D=t(2878),C=t(78974),j=t(77142),w=t(98298),A=t(8533),S=t(68088),P=t(56543),M=t(2911),I=t(88186),O=t(46263),k=t(88258),T=t(7130);const F=()=>[{name:"note",label:"Note",valueKey:"note",value:"",type:"textarea",validationType:"string",validations:[{type:"required",params:["Note is Required!"]}],isEditable:!0,pluginConfiguration:{rows:3},classes:{wrapper:"col-12",label:"",field:"form-control vh-60",error:""}}];var E=t(30087),R=t(63194),_=t(45859),U=t(52191),Y=t(93182),L=t(70579);function H(e){let{card:a,patientId:t,rowData:l,index:o,setMainState:d,className:s="",data:r=[]}=e;const[c,p]=(0,i.useState)({create:!1,update:!1}),m=(0,i.useCallback)((()=>p((e=>({...e,create:!1,update:!1})))),[]),v=(0,i.useCallback)((async(e,a,i)=>{"create"===a?await(0,S.vX)({func:async(a,i)=>{try{const i=await Y.A.noteCreate({payload:{patientId:t,...e}});1===(null===i||void 0===i?void 0:i.status)&&d((e=>{var a;return{...e,patientData:{...e.patientData,patientNotes:[i.data,...null===(a=e.patientData)||void 0===a?void 0:a.patientNotes]}}})),a(1)}catch(l){console.error(l),i(0)}},loading:"Creating note.",error:"Could not create note.",success:"note created.",options:{id:"create-notes"}}):"update"===a&&await(0,S.vX)({func:async(a,t)=>{try{const t=await Y.A.noteUpdate({payload:{...e,id:i}});d((e=>{var a;return{...e,patientData:{...e.patientData,patientNotes:null===(a=e.patientData)||void 0===a?void 0:a.patientNotes.map((e=>e.id===t.data.id?{...e,...t.data}:e))}}})),a(1)}catch(l){console.error(l),t(0)}},loading:"Updating note.",error:"Could not update note.",success:"note updated.",options:{id:"update-notes"}}),m()}),[m,t,d]),h=(0,i.useCallback)((async e=>{(0,U.vW)({title:"Are you sure to delete the selected note?",onDone:async()=>{await Y.A.noteDelete({payload:{id:e}}),d((a=>{var t;return{...a,patientData:{...a.patientData,patientNotes:null===(t=a.patientData)||void 0===t?void 0:t.patientNotes.filter((a=>a.id!==e))}}}))}})}),[d]),f=(0,i.useMemo)((()=>[{field:"actions",headerName:"Actions",type:"actions",minWidth:180,getActions:e=>[(0,L.jsx)(y.or,{onClick:()=>p((a=>({...a,update:e.row})))}),(0,L.jsx)(y.Jx,{onClick:()=>h(e.id)})]},{field:"date",headerName:"Date",minWidth:180,flex:0,renderCell:e=>(0,L.jsx)(L.Fragment,{children:n()().format("MM/DD/YY")})},{field:"notes",headerName:"Notes",minWidth:200,flex:1,renderCell:e=>(0,L.jsx)("div",{className:"line-clamp line-clamp-3 my-2",children:e.row.note})}]),[h]),x=(0,i.useMemo)((()=>(0,_.yN)(r,"createdAt")),[r]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(k.A,{className:"card p-2 m-1",children:[(0,L.jsx)("div",{className:"d-flex justify-content-between",children:(0,L.jsx)("div",{className:"accordion-button collapsed cursor-pointer","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapse-".concat(a.id,"-").concat(t),"aria-expanded":"false","aria-controls":"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),children:(0,L.jsx)("div",{className:"".concat(T.A.title," font-weight-bold"),children:"".concat(null!==l&&void 0!==l&&l.firstName?"".concat(null===l||void 0===l?void 0:l.firstName," ").concat(null!==l&&void 0!==l&&l.lastName?null===l||void 0===l?void 0:l.lastName:""," -"):"","  Notes")})})}),(0,L.jsx)("div",{id:"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),className:"accordion-collapse collapse show","aria-labelledby":"card-".concat(a.id),children:(0,L.jsxs)("div",{className:"accordion-body",children:[(0,L.jsx)("div",{className:"my-2 cstm-mui-datagrid ".concat(null!==x&&void 0!==x&&x.length?"not_loading":"loading"),style:{maxHeight:"88vh",width:"100%",flexGlow:1},children:(0,L.jsx)(D.C,{columns:f,rows:x||[],autoHeight:!0,density:"compact",disableColumnFilter:!0,getRowHeight:()=>"auto",onRowClick:e=>{let{row:a}=e;return p((e=>({...e,update:a})))},components:{LoadingOverlay:g.A,Footer:()=>(0,L.jsx)(L.Fragment,{})}})}),(0,L.jsx)(u.A,{variant:"primary",size:"sm",onClick:e=>{p((e=>({...e,create:!0})))},children:"Add Notes"})]})}),(0,L.jsx)("div",{className:"d-flex",children:(0,L.jsx)(z,{fieldName:"Notes",showModal:Boolean(c.create||c.update),onSubmit:v,onCancel:m,mode:c.create?"create":c.update&&"update",updateData:c.update})})]})})}const z=e=>{let{showModal:a,onSubmit:t,onCancel:l,mode:o="create",updateData:d,fieldName:s="field",patientId:r}=e,c=(0,i.useMemo)((()=>F().map((e=>(d&&("dueDate"===e.name?e.value=n()(d[e.name]).toDate():d.hasOwnProperty(e.name)&&(e.value=d[e.name])),e)))),[d]);return(0,L.jsx)(E.A,{header:(0,L.jsx)(L.Fragment,{children:"update"===o?"Edit "+s:"Create "+s}),toggle:l,show:a,size:"lg",body:a&&(0,L.jsx)(R.A,{className:"m-0",formClassName:"row",dataFields:c,onSubmit:e=>t(e,o,"update"===o&&d.id||r)})})},W=()=>[{name:"name",label:"Contact Name",valueKey:"name",value:"",type:"text",validationType:"string",validations:[{type:"required",params:["Relative name is required!"]}],isEditable:!0,classes:{wrapper:"col-12",label:"",field:"form-control",error:""}},{name:"contactNumber",label:"Contact number",valueKey:"contactNumber",value:"",type:"text",validationType:"string",validations:[{type:"required",params:["Relative number is required!"]}],isEditable:!0,classes:{wrapper:"col-12 col-md-6",label:"",field:"form-control",error:""}},{name:"priority",label:"Priority",valueKey:"priority",value:"",type:"text",validationType:"string",validations:[],isEditable:!0,classes:{wrapper:"col-12 col-md-6",label:"",field:"form-control",error:""}},{name:"relation",label:"Relation",valueKey:"relation",value:"",type:"text",validationType:"string",validations:[],isEditable:!0,classes:{wrapper:"col-12 col-md-6",label:"",field:"form-control",error:""}},{name:"typeOfNumber",label:"Phone Type",valueKey:"typeOfNumber",value:"",type:"text",validationType:"string",validations:[],isEditable:!0,classes:{wrapper:"col-12 col-md-6",label:"",field:"form-control",error:""}},{name:"note",label:"Notes",valueKey:"note",value:"",type:"text",validationType:"string",validations:[],isEditable:!0,classes:{wrapper:"col-12",label:"",field:"form-control",error:""}}];var K=t(82051),B=t(8155);class G extends B.A{async create(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t,...P.M.API_TIMEOUT.L2};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/create",n,o)}async update(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/update",n,o)}async delete(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/delete",n,o)}}const V=new G("/patientguardian");function q(e){let{card:a,patientId:t,rowData:l,index:n,setMainState:o,className:d="",data:s=[]}=e;const[r,c]=(0,i.useState)({page:1,total:0,pageSize:10,rowCountState:0,loading:!1,filters:{search:null,designation:null,status:null},create:!1,update:!1}),p=(0,i.useCallback)((()=>c((e=>({...e,create:!1,update:!1})))),[]),m=(0,i.useCallback)((e=>{r.update?o((a=>{var t;return{...a,patientData:{...a.patientData,patientGuardians:null===(t=a.patientData)||void 0===t?void 0:t.patientGuardians.map((a=>a.id===e.data.id?{...a,...e.data}:a))}}})):1===(null===e||void 0===e?void 0:e.status)&&o((a=>{var t;return{...a,patientData:{...a.patientData,patientGuardians:[e.data,...null===(t=a.patientData)||void 0===t?void 0:t.patientGuardians]}}}))}),[o,r.update]),v=(0,i.useCallback)((async e=>{(0,U.vW)({title:"Are you sure to remove the selected relative data?",onDone:async()=>{await V.delete({payload:{id:e}}),o((a=>{var t;return{...a,patientData:{...a.patientData,patientGuardians:null===(t=a.patientData)||void 0===t?void 0:t.patientGuardians.filter((a=>a.id!==e))}}}))}})}),[o]),h=(0,i.useMemo)((()=>[{field:"actions",type:"actions",headerName:"Actions",flex:1,getActions:e=>[(0,L.jsx)(y.or,{onClick:()=>c((a=>({...a,update:e.row})))}),(0,L.jsx)(y.Jx,{onClick:()=>v(e.id)})]},{field:"name",headerName:"name",flex:1},{field:"relation",headerName:"Relation",flex:1},{field:"contactNumber",headerName:"Phone",flex:1},{field:"typeOfNumber",headerName:"Phone type",flex:1},{field:"priority",headerName:"Priority",flex:1},{field:"note",headerName:"Notes"}]),[v]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(k.A,{className:"card p-2 m-1",children:[(0,L.jsx)("div",{className:"d-flex justify-content-between",children:(0,L.jsx)("div",{className:"accordion-button collapsed cursor-pointer","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapse-".concat(a.id,"-").concat(t),"aria-expanded":"false","aria-controls":"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),children:(0,L.jsx)("div",{className:"".concat(T.A.title," font-weight-bold"),children:"".concat(null!==l&&void 0!==l&&l.firstName?"".concat(null===l||void 0===l?void 0:l.firstName," ").concat(null!==l&&void 0!==l&&l.lastName?null===l||void 0===l?void 0:l.lastName:""," -"):""," Next of Kin")})})}),(0,L.jsx)("div",{id:"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),className:"accordion-collapse collapse show","aria-labelledby":"card-".concat(a.id),children:(0,L.jsxs)("div",{className:"accordion-body",children:[(0,L.jsx)("div",{className:"my-2 cstm-mui-datagrid ".concat(null!==s&&void 0!==s&&s.length?"not_loading":"loading"),style:{maxHeight:"88vh",width:"100%",flexGlow:1},children:(0,L.jsx)(D.C,{rows:s||[],columns:h,autoHeight:!0,density:"compact",disableColumnFilter:!0,onRowClick:e=>{let{row:a}=e;return c((e=>({...e,update:a})))},components:{LoadingOverlay:g.A,Footer:()=>(0,L.jsx)(L.Fragment,{})}})}),(0,L.jsx)(u.A,{variant:"primary",size:"sm",onClick:e=>{c((e=>({...e,create:!0})))},children:"Add Contact"})]})}),(0,L.jsx)(J,{fieldName:"Relative",showModal:Boolean(r.create||r.update),onSubmitSuccess:m,onCancel:p,patientId:t,mode:r.create?"create":r.update&&"update",updateData:r.update})]})})}const J=e=>{let{showModal:a,onSubmitSuccess:t,onCancel:l,mode:o="create",updateData:d,fieldName:s="field",patientId:r,directSubmit:c}=e;const u=(0,i.useCallback)((async(e,a,i)=>{if(c)return"create"===a&&(e.id=Date.now()),t(e),void l();"create"===a?await(0,S.vX)({func:async(a,i)=>{try{const i=await V.create({payload:{patientId:r,...e}});t(i),a(1)}catch(l){console.error(l),i(0)}},loading:"Creating...",error:"Could not create.",success:" created.",options:{id:"create-patient"}}):"update"===a&&await(0,S.vX)({func:async(a,l)=>{try{const l=await V.update({payload:{...e,id:i}});t(l),a(1)}catch(n){console.error(n),l(0)}},loading:"Updating...",error:"Could not update.",success:"Updated.",options:{id:"update-patient"}}),l()}),[l,r,t,c]);let p=(0,i.useMemo)((()=>W().map((e=>(d&&("dueDate"===e.name?e.value=n()(d[e.name]).toDate():d.hasOwnProperty(e.name)&&(e.value=d[e.name])),e)))),[d]);return(0,L.jsx)(E.A,{header:(0,L.jsx)(L.Fragment,{children:"update"===o?"Edit "+s:"Create "+s}),toggle:l,show:a,body:a&&(0,L.jsx)(R.A,{className:"m-0",formClassName:"row",dataFields:p,onSubmit:e=>u(e,o,"update"===o&&d.id)})})};var X=t(61072),Q=t(33817),$=t(78602),Z=t(17392),ee=t(82005);function ae(e){let{data:a,startImgID:t,showResourceCount:l=!0,onCloseImageHandler:n}=e;const o=(0,i.useMemo)((()=>a.filter((e=>["image","video"].includes(e.mediaType.split("/").shift()))).map((e=>"video"===e.mediaType.split("/").shift()?{...e,url:e.mediaUrl,type:"video",title:"video title"}:{...e,url:e.mediaUrl,type:"photo",altTag:"Alt Photo"}))),[a]),d=(0,i.useMemo)((()=>t?o.findIndex((e=>e.id===t)):0),[o,t]);return(0,L.jsx)("div",{className:"modal modal-lg-fullscreen fade show d-block task-image-gallery",id:"imageGallery",tabIndex:-1,role:"dialog","aria-labelledby":"dropZoneLabel","aria-modal":"true",children:(0,L.jsx)(ee.A,{data:o,startIndex:d,showResourceCount:l,onCloseCallback:n})})}var te=t(43700),ie=t(63471),le=t(95540),ne=t(9762),oe=t(78423);function de(e){let{data:a,onEdit:t,onUpdate:i,onDelete:l,imagesData:o=[]}=e;const{imageId:d}=(0,w.d4)((e=>e.chat));return d?(0,L.jsx)(ae,{data:o,startImgID:d,onCloseImageHandler:()=>(0,j.JD)({type:te.f.IMAGE_INDEX,payload:0})}):(0,L.jsx)($.A,{md:4,children:(0,L.jsxs)(k.A,{className:"flex-row",children:[a.mediaType.includes("image")?(0,L.jsx)(k.A.Img,{variant:"left",src:(0,S.bv)(a.mediaUrl,"200x200",!1),height:"auto",width:200,className:"cursor-pointer",onClick:()=>(0,j.JD)({type:te.f.IMAGE_INDEX,payload:a.id})}):(0,L.jsx)("div",{style:{height:"auto",width:"200px",cursor:"pointer"},onClick:()=>{(0,ne.yv)(oe.i.PDF_VIEWER),(0,j.JD)({type:te.f.SET_PDF_URL,payload:a.mediaUrl,fileName:a.fileName,id:a.id})},children:(0,L.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,L.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,L.jsxs)(k.A.Body,{className:"d-flex flex-column justify-content-between",children:[(0,L.jsx)(k.A.Text,{className:"line-clamp line-clamp-6",children:a.note}),(0,L.jsx)("div",{className:"d-flex align-items-center",children:(0,L.jsxs)("div",{className:"mb-0",children:[(0,L.jsx)(U.vL,{title:"Edit",children:(0,L.jsx)(Z.A,{color:"primary",onClick:()=>t(a),children:(0,L.jsx)(le.A,{})})}),(0,L.jsx)(U.vL,{title:"Delete",children:(0,L.jsx)(Z.A,{color:"secondary",onClick:()=>l(a.id),children:(0,L.jsx)(ie.A,{})})}),(0,L.jsx)(k.A.Text,{className:"desg-tag mb-0 mt-1",children:"Created on ".concat(n()(a.createdAt).format("MM/DD/YY"))})]})})]})]})})}var se=t(37762),re=t(33155),ce=t(22581),ue=t(10660);const pe={imageFiles:[],isUploading:!1,pdfName:"",pdfCaption:"",pdfUploadLoad:null,uploadLoad:null,note:"",setProfilePic:!1},me=e=>{var a,t,l;let{showModal:o,type:d,onSubmit:s,onCancel:r,mode:c="create",updateData:p,fieldName:m="field",patientId:v}=e;const[h,f]=(0,i.useState)(pe),g=(0,i.useRef)();(0,i.useEffect)((()=>{o&&!p&&setTimeout((()=>{var e;null===g||void 0===g||null===(e=g.current)||void 0===e||e.click()}),200),p&&f((e=>({...e,note:p.note})))}),[o,p]);const y=(0,i.useCallback)((async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=e.file,i=await(0,ce.wQ)(t);return{mediaUrl:await(0,ce.hl)(i,t,(e=>{f(a?a=>({...a,pdfUploadLoad:parseInt(100*e.progress)}):a=>({...a,uploadLoad:parseInt(100*e.progress)}))})),mediaType:t.type,fileName:t.name}}),[]),x=(0,i.useCallback)((async()=>{const e=new se.Ay("p",""),a=h.pdfName||"HCMD_PDF_"+n()().format("MM/DD/YY"),t=e.internal.pageSize.getWidth();h.imageFiles.forEach(((a,i)=>{const{file:l}=a,n=URL.createObjectURL(l);e.addImage(n,"any",5,5,t-10,0),e.addPage()})),e.deletePage(h.imageFiles.length+1);let i=e.output("blob"),l=new Blob([i],{type:"application/pdf"});l.name=a;const o=new File([l],"".concat(a,".pdf"),{type:l.type});return await y({file:o,name:h.pdfName,caption:h.pdfCaption},!0)}),[h.imageFiles,h.pdfName,h.pdfCaption,y]),b=(0,i.useCallback)((async()=>{let e={},a={note:h.note};h.error||(h.imageFiles.length?(f((e=>({...e,isUploading:!0}))),1===h.imageFiles.length?e=await y(h.imageFiles[0]):h.imageFiles.length>1&&(e=await x())):p.mediaUrl&&(e.mediaUrl=p.mediaUrl),a={...a,...e},h.setProfilePic&&(a.profilePicture=!0),f(pe),s(a,c,(null===p||void 0===p?void 0:p.id)||v))}),[y,x,c,s,v,h.error,h.imageFiles,h.note,null===p||void 0===p?void 0:p.id,h.setProfilePic,null===p||void 0===p?void 0:p.mediaUrl]),N=(0,i.useCallback)((e=>{let a=[];return Array.from(e).map(((e,t)=>{const i={id:t,file:e,name:e.name,caption:"",uploadLoad:0};return e.type.includes("image"),a.push(i),null})),f((e=>({...e,imageFiles:a}))),()=>{f(pe)}}),[]),D=(0,i.useCallback)((()=>{N([])}),[N]);return(0,L.jsx)(E.A,{show:o,size:"lg",header:(0,L.jsx)(L.Fragment,{children:"update"===c?"Edit "+m:"Create "+m}),toggle:r,body:o&&(0,L.jsxs)(X.A,{children:[(0,L.jsx)($.A,{md:12,children:(0,L.jsx)(re.Ay,{onDrop:N,children:e=>{let{getRootProps:a,getInputProps:t}=e;return(0,L.jsx)("section",{className:"border-1 text-center py-2",children:(0,L.jsxs)("div",{...a(),children:[(0,L.jsx)("input",{...t(),type:"file",id:"filePictureInput",accept:"image/jpeg, image/jpg, image/png",ref:g,className:"dropzone-input"}),(0,L.jsx)("p",{className:"py-2 mb-0 text-color",children:"Drag / drop files here, or click to select files"}),p&&(0,L.jsx)("small",{className:"text-muted",children:"Please select files to update"})]})})}})}),(0,L.jsx)($.A,{md:12,children:!(null===h||void 0===h||null===(a=h.imageFiles)||void 0===a||!a.length)&&(0,L.jsx)(L.Fragment,{children:(null===h||void 0===h?void 0:h.imageFiles.length)>1?(0,L.jsx)(ue.K1,{state:h,setState:f}):h.imageFiles.map((e=>(0,L.jsx)(ue.oU,{item:e,isUploading:h.isUploading,setState:f,progress:h.isUploading&&{value:e.uploadLoad},OnClose:D},e.id)))})}),(!(null===h||void 0===h||null===(t=h.imageFiles)||void 0===t||!t.length)&&1===(null===h||void 0===h||null===(l=h.imageFiles)||void 0===l?void 0:l.length)||"update"===c&&p.mediaType.includes("image"))&&(0,L.jsx)($.A,{md:12,className:"mt-2",children:(0,L.jsxs)("div",{className:"custom-control custom-checkbox",children:[(0,L.jsx)("input",{className:"custom-control-input",id:"select-all",name:"select-all",type:"checkbox",value:-2,checked:h.setProfilePic,onChange:e=>f((a=>({...a,setProfilePic:e.target.checked})))}),(0,L.jsx)("label",{className:"custom-control-label",htmlFor:"select-all",children:"Set as profile picture"})]})}),(0,L.jsx)($.A,{md:12,children:(0,L.jsxs)("div",{className:"form-group my-2",children:[(0,L.jsx)("label",{htmlFor:"groupName",children:"Notes: "}),(0,L.jsx)("textarea",{className:"form-control form-control-md",id:"note",name:"note",placeholder:"Type Notes here",autoComplete:"off",maxLength:250,rows:5,onChange:e=>f((a=>({...a,note:e.target.value}))),value:h.note,required:!0})]})})]}),footer:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(u.A,{variant:"secondary",onClick:r,children:"Cancel"}),(0,L.jsx)(u.A,{variant:"primary",onClick:b,disabled:h.isUploading,children:h.isUploading?"Saving...":"Save"})]})})};function ve(e){let{rowData:a,type:t="image",card:l,patientId:n,index:o,setMainState:d,setPatientProfile:s,data:r=[]}=e;const[c,p]=(0,i.useState)({create:!1,update:!1,loading:!1,text:""}),m=(0,i.useCallback)((()=>p((e=>({...e,create:!1,update:!1})))),[]),v=(0,i.useCallback)((async(e,a,t)=>{"create"===a?await(0,S.vX)({func:async(a,t)=>{try{const t=await Y.A.attachmentCreate({payload:{patientId:n,...e}});1===(null===t||void 0===t?void 0:t.status)&&d((e=>({...e,patientData:{...e.patientData,patientAttachments:[t.data,...e.patientData.patientAttachments]}}))),a(1)}catch(i){console.error(i),t(0)}},loading:"Creating File Data.",error:"Could not create File Data.",success:"File data created.",options:{id:"create-picture"}}):"update"===a&&await(0,S.vX)({func:async(a,i)=>{try{const i=await Y.A.attachmentUpdate({payload:{...e,patientId:n,id:t}});d((e=>({...e,patientData:{...e.patientData,patientAttachments:e.patientData.patientAttachments.map((e=>e.id===i.data.id?{...e,...i.data}:e))}}))),a(1)}catch(l){console.error(l),i(0)}},loading:"Updating File Data.",error:"Could not update File Data.",success:"File Data updated.",options:{id:"update-picture"}}),e.profilePicture&&s(n,e.mediaUrl),m()}),[m,n,d,s]),h=(0,i.useCallback)((async e=>{(0,U.vW)({title:"Are you sure about to delete the attached content?",onDone:async()=>{await Y.A.attachmentDelete({payload:{id:e}}),d((a=>{var t;return{...a,patientData:{...a.patientData,patientAttachments:null===(t=a.patientData)||void 0===t?void 0:t.patientAttachments.filter((a=>a.id!==e))}}}))}})}),[d]),f=(0,i.useMemo)((()=>(0,_.yN)(r,"createdAt")),[r]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(k.A,{className:"card p-2 m-1",children:[(0,L.jsx)("div",{className:"d-flex justify-content-between",children:(0,L.jsx)("div",{className:"accordion-button collapsed cursor-pointer d-flex justify-content-between","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapse-".concat(l.id,"-").concat(n),"aria-expanded":"false","aria-controls":"panelsStayOpen-collapse-".concat(l.id,"-").concat(n),children:(0,L.jsx)("div",{className:"".concat(T.A.title," font-weight-bold"),children:"".concat(null!==a&&void 0!==a&&a.firstName?"".concat(null===a||void 0===a?void 0:a.firstName," ").concat(null!==a&&void 0!==a&&a.lastName?null===a||void 0===a?void 0:a.lastName:""," -"):""," Picture Data")})})}),(0,L.jsx)("div",{id:"panelsStayOpen-collapse-".concat(l.id,"-").concat(n),className:"accordion-collapse collapse show","aria-labelledby":"card-".concat(l.id),children:(0,L.jsxs)("div",{className:"accordion-body",children:[(0,L.jsx)("div",{className:"my-1 overflow-auto hide-horizonal-scroll",style:{maxHeight:"300px"},children:(0,L.jsx)(X.A,{children:f.length?f.map(((e,a)=>(0,L.jsx)(de,{imagesData:f,data:e,onUpdate:v,onDelete:h,onEdit:()=>p((a=>({...a,update:e})))},a))):(0,L.jsxs)("div",{className:"w-100 text-center text-muted",children:[(0,L.jsx)(Q.A,{size:20}),(0,L.jsx)("p",{className:"mb-0 text-muted",children:"No data available"})]})})}),(0,L.jsx)(u.A,{variant:"primary",size:"sm",onClick:e=>p((e=>({...e,create:!0}))),children:"Add ".concat("audio"===t?"Dictation":"Picture")})]})}),(0,L.jsx)(me,{type:t,fieldName:"audio"===t?"Dictation":"Picture Data",showModal:Boolean(c.create||c.update),onSubmit:v,onCancel:m,mode:c.create?"create":c.update&&"update",updateData:c.update})]})})}var he=t(63574);const fe=[{label:"Routine",value:P.M.MSG_TYPE.ROUTINE},{label:"Urgent",value:P.M.MSG_TYPE.URGENT},{label:"Emergency",value:P.M.MSG_TYPE.EMERGENCY}],ge=()=>[{name:"title",label:"Task",valueKey:"title",value:"",type:"textarea",validationType:"string",validations:[{type:"required",params:["Task is Required!"]}],classes:{wrapper:"col-12",label:"",field:"form-control",error:""},autoFocus:!0,isEditable:!0,pluginConfiguration:{rows:2}},{name:"assigneeId",label:"Assignee",valueKey:"assigneeId",value:"",placeholder:"Select assignee",type:"select",validationType:"array",validations:[],isEditable:!0,optionKey:{url:he.E.URL+"/user/list",payload:{query:{isActive:!0},options:{sort:[["name","asc"]],populate:["users:own"]},keys:["name","firstName","lastName"],value:""},method:"post",labelField:"name",valueField:"id"},pluginConfiguration:{isAsyncSelect:!0,isClearable:!0,defaultOptions:!0},classes:{wrapper:"col-12",label:"",field:"",error:""}},{name:"dueDate",label:"Due Date",valueKey:"dueDate",value:"",type:"date",validationType:"string",validations:[],isEditable:!0,classes:{wrapper:"col-md-6 col-12",label:"",field:"form-control",error:""},pluginConfiguration:{isDateRange:!1}},{name:"priority",label:"Priority",valueKey:"priority",value:[fe[0]],type:"select",validationType:"array",validations:[],isEditable:!0,options:fe,classes:{wrapper:"col-12 col-md-6",label:"",field:"",error:""},pluginConfiguration:{}}];var ye=t(98606),xe=t(80870);function be(e){let{card:a,patientId:t,rowData:l,index:o,setMainState:d,data:s=[]}=e;const[r,c]=(0,i.useState)({create:!1,update:!1,loading:!1,text:""}),p=(0,i.useCallback)((()=>c((e=>({...e,create:!1,update:!1})))),[]),m=(0,i.useCallback)((async(e,a,i)=>{"create"===a?await(0,S.vX)({func:async(a,i)=>{try{const i={...e,patientId:t,title:e.title},l=await Y.A.taskCreate({payload:i});1===(null===l||void 0===l?void 0:l.status)&&d((e=>({...e,patientData:{...e.patientData,patientTasks:[l.data,...e.patientData.patientTasks]}}))),a(1)}catch(l){console.error(l),i(0)}},loading:"Creating task.",error:"Could not create task.",success:"task created.",options:{id:"create-todo"}}):"update"===a&&await(0,S.vX)({func:async(a,t)=>{try{const t=await Y.A.taskUpdate({payload:{...e,id:i}});d((e=>({...e,patientData:{...e.patientData,patientTasks:e.patientData.patientTasks.map((e=>e.id===t.data.id?{...e,...t.data}:e))}}))),a(1)}catch(l){console.error(l),t(0)}},loading:"Updating task.",error:"Could not update task.",success:"task updated.",options:{id:"update-todo"}}),p()}),[p,t,d]),v=(0,i.useCallback)((async e=>{(0,U.vW)({title:"Are you sure about to delete the todo?",onDone:async()=>{await Y.A.taskDelete({payload:{id:e}}),d((a=>({...a,patientData:{...a.patientData,patientTasks:a.patientData.patientTasks.filter((a=>a.id!==e))}})))}})}),[d]),h=(0,i.useMemo)((()=>[{field:"title",headerName:"Task",minWidth:200,renderCell:e=>{let{row:a}=e;return(0,L.jsx)("div",{children:a.title})}},{field:"date",headerName:"Date",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:n()(a.createdAt).format("MM/DD/YY")})}},{field:"assigneeId",headerName:"Assignee",minWidth:180,renderCell:e=>{var a,t;let{row:i}=e;return(0,L.jsx)(L.Fragment,{children:null!==(a=i.patientAssignee)&&void 0!==a&&a.name?null===(t=i.patientAssignee)||void 0===t?void 0:t.name:"-"})}},{field:"priority",headerName:"Priority",minWidth:180,cellClassName:"text-capitalize"},{field:"dueDate",headerName:"Due date",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.dueDate?n()(a.dueDate).format("MM/DD/YY"):"-"})}},{field:"repeat",headerName:"Repeative",minWidth:180,flex:1},{field:"status",headerName:"Status",minWidth:180,flex:1},{field:"actions",headerName:"Actions",minWidth:180,align:"center",headerAlign:"center",renderCell:e=>{let{row:a}=e;return(0,L.jsxs)("div",{onClick:e=>e.stopPropagation(),children:[(0,L.jsx)(y.y0,{tooltip:"Mark as Done",Icon:P.M.TASK_STATUS[3].value===a.status?ye.A:xe.A,color:P.M.TASK_STATUS[3].value===a.status?"success":"primary",onClick:()=>m({status:P.M.TASK_STATUS[3].value===a.status?P.M.TASK_STATUS[0].value:P.M.TASK_STATUS[3].value},"update",a.id)}),(0,L.jsx)(y.or,{tooltip:"Edit Task",onClick:()=>c((e=>({...e,update:a})))}),(0,L.jsx)(y.Jx,{tooltip:"Delete Task",onClick:()=>v(a.id)})]})}}]),[v,m]),f=(0,i.useMemo)((()=>(0,_.yN)(s,"createdAt")),[s]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(k.A,{className:"card p-2 m-1",children:[(0,L.jsx)("div",{className:"d-flex justify-content-between",children:(0,L.jsx)("div",{className:"accordion-button collapsed cursor-pointer","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapse-".concat(a.id,"-").concat(t),"aria-expanded":"false","aria-controls":"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),children:(0,L.jsx)("div",{className:"".concat(T.A.title," font-weight-bold"),children:"".concat(null!==l&&void 0!==l&&l.firstName?"".concat(null===l||void 0===l?void 0:l.firstName," ").concat(null!==l&&void 0!==l&&l.lastName?null===l||void 0===l?void 0:l.lastName:""," -"):""," Todo List")})})}),(0,L.jsx)("div",{id:"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),className:"accordion-collapse collapse show","aria-labelledby":"card-".concat(a.id),children:(0,L.jsxs)("div",{className:"accordion-body",children:[(0,L.jsx)("div",{className:"my-2 cstm-mui-datagrid ".concat(null!==f&&void 0!==f&&f.length?"not_loading":"loading"),style:{maxHeight:"88vh",width:"100%",flexGlow:1},children:(0,L.jsx)(D.C,{columns:h,rows:null!==f&&void 0!==f&&f.length?f:[],autoHeight:!0,density:"compact",disableColumnFilter:!0,onRowClick:e=>{let{row:a}=e;return c((e=>({...e,update:a})))},components:{LoadingOverlay:g.A,Footer:()=>(0,L.jsx)(L.Fragment,{})}})}),(0,L.jsx)(u.A,{variant:"primary",size:"sm",onClick:e=>c((e=>({...e,create:!0}))),children:"Add Todo"})]})}),(0,L.jsx)("div",{className:"d-flex",children:(0,L.jsx)(Ne,{fieldName:"Todo",showModal:r.create||r.update,onSubmit:m,onCancel:p,mode:r.create?"create":r.update&&"update",rowData:l,updateData:r.update})})]})})}const Ne=e=>{let{showModal:a,onSubmit:t,onCancel:l,mode:o="create",updateData:d,fieldName:s="field",patientId:r,rowData:c}=e,u=(0,i.useMemo)((()=>ge().map((e=>{if(d)if("dueDate"===e.name)e.value=d[e.name]?n()(d[e.name]).toDate():null;else if("assigneeId"===e.name)e.value=d.patientAssignee?[{label:d.patientAssignee.name,value:d.patientAssignee.id}]:[];else if("priority"===e.name&&d.hasOwnProperty("priority")){const a=fe.find((e=>e.value===d.priority));e.value=a?[a]:[]}else d.hasOwnProperty(e.name)&&(e.value=d[e.name]);return e}))),[d]);const p=(0,i.useCallback)((async e=>{var a,i;e.hasOwnProperty("assigneeId")&&e.assigneeId.length?e.assigneeId=(null===(a=e.assigneeId[0])||void 0===a?void 0:a.value)||null:e.assigneeId=null,e.hasOwnProperty("priority")&&e.priority.length&&(e.priority=(null===(i=e.priority[0])||void 0===i?void 0:i.value)||null),e.patientName=c?"".concat(c.firstName?"".concat(c.firstName,"-"):"").concat(c.lastName?c.lastName:""):void 0,await t(e,o,"update"===o&&d.id||r)}),[o,t,r,c,null===d||void 0===d?void 0:d.id]);return(0,L.jsx)(E.A,{header:(0,L.jsx)(L.Fragment,{children:"update"===o?"Edit "+s:"Create "+s}),toggle:l,show:a,size:"lg",body:a&&(0,L.jsx)(R.A,{className:"m-0",formClassName:"row",dataFields:u,onSubmit:p})})};var De=t(99181),Ce=t(25892);const je={label:"",note:"",file:null,uploading:!1,comment:""},we=e=>{let{showModal:a,type:t,onSubmit:i,onCancel:l,mode:o="create",updateData:d,continueDictation:s,fieldName:r="field",patientId:c,visitDate:u=n()().toLocaleString()}=e;return(0,L.jsx)(E.A,{show:a,size:"lg",header:(0,L.jsx)(L.Fragment,{children:s?"Continue Dictation of ".concat(s.label||"Unknown label"):"update"===o?"Edit "+r:"Create "+r}),toggle:l,body:a&&(0,L.jsx)(Ae,{visitDate:u,onSubmit:i,mode:o,patientId:c,continueDictation:s})})},Ae=e=>{let{visitDate:a,onSubmit:t,mode:l,patientId:o,continueDictation:d}=e;const[r,c]=(0,i.useState)({...je,date:a}),u=(0,i.useCallback)((e=>{const{value:a,name:t}=e.target;c((e=>({...e,[t]:a})))}),[]),p=(0,i.useCallback)((async e=>{let{fileType:i,fileName:d,uploadedAudioUrl:s,fileData:u}=e;navigator.onLine&&(await t({fileName:d,mediaType:i,mediaUrl:s,note:r.note,label:r.label,comment:r.comment,createdAt:r.date,dictationDate:n()(r.date).format("YYYY-MM-DD")},l,o),c({...je,date:a}))}),[l,t,o,r,a]);return(0,L.jsxs)(X.A,{children:[!d&&(0,L.jsxs)($.A,{children:[(0,L.jsx)(Ce.A,{Label:"Label",placeholder:"Enter Label",name:"label",handleChange:u,formgroupClass:"",type:"text",error:"",isRequired:!1,value:r.label}),(0,L.jsx)(Ce.A,{Label:"Notes",placeholder:"Type notes here",name:"note",handleChange:u,formgroupClass:"",type:"text",error:"",isRequired:!1,value:r.note}),(0,L.jsx)(Ce.A,{Label:"Comment",placeholder:"Type comments here",name:"comment",handleChange:u,formgroupClass:"",type:"text",error:"",isRequired:!1,value:r.comment}),(0,L.jsxs)("div",{className:"form-group cstm-datepicker",children:[(0,L.jsx)("label",{htmlFor:"dictationDate",children:"Dictation date"}),(0,L.jsx)(s(),{id:"dictation_date",name:"dictationDate",placeholderText:"Dictation date",className:"form-control flex-grow-1 bg-dark-f input-border text-color font-inherit",selected:r.date?new Date(r.date):null,value:r.date?new Date(r.date):null,onChange:e=>c((a=>({...a,date:e}))),isClearable:!0,autoComplete:"off"})]})]}),(0,L.jsx)($.A,{className:"my-1",md:12,children:(0,L.jsx)(De.A,{setRecorder:()=>{},onSubmitAudio:p,type:"dictation",parentFile:d,visitDate:a})})]})};var Se=t(76263),Pe=t(8354);function Me(e){let{activeAudio:a,onClose:t,onContinueDictation:l,onDeleteAttachment:n}=e;const o=(0,i.useCallback)((e=>{n(e,null===a||void 0===a?void 0:a.id)}),[n,null===a||void 0===a?void 0:a.id]),d=(0,i.useMemo)((()=>[{children:(0,L.jsx)(Ie,{audio:a,autoPlay:!0,onDelete:o}),color:"green"}]),[a,o]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(E.A,{header:"Dictation",Modalprops:{className:"text-color"},show:Boolean(a),toggle:t,size:"lg",bodyProps:{style:{overflow:"auto",maxHeight:window.innerWidth<767?"calc(100vh - 100px)":"calc(100vh - 180px)"}},body:a&&(0,L.jsx)(X.A,{children:(0,L.jsx)($.A,{children:(0,L.jsx)(Se.A,{items:d,className:"mt-2"})})}),footer:(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)("div",{className:"d-flex gap-10",children:[(0,L.jsx)(u.A,{variant:"secondary",onClick:t,children:"Close"}),(0,L.jsx)(u.A,{onClick:()=>l(a),children:"Continue Dictation"})]})})})})}const Ie=e=>{let{audio:a,autoPlay:t,onDelete:i,index:l}=e;return(0,L.jsxs)("div",{className:"d-flex flex-column",children:[(0,L.jsx)(Pe.A,{className:"d-flex text-color mt-0 mb-2",style:{borderColor:"grey"},orientation:"left",children:a.label?a.label:"Unknown label"}),(0,L.jsx)("div",{className:"d-flex align-items-center w-100",children:(0,L.jsxs)("audio",{controls:!0,id:"audio-"+a.id,preload:"metadata",className:"w-100 my-0",autoPlay:t,children:[(0,L.jsx)("source",{src:(0,S.g5)(a.mediaUrl,!1),type:"audio/mpeg"}),(0,L.jsx)("source",{src:(0,S.g5)(a.mediaUrl,!1),type:"audio/ogg"}),"Your browser does not support the audio element."]})}),(0,L.jsxs)("div",{className:"my-1 w-100",children:[(0,L.jsx)("p",{className:"mb-1",children:"Notes: ".concat(a.note?a.note:"N/A")}),(0,L.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,L.jsx)("h6",{className:"mb-0",children:"File: ".concat(a.fileName)}),(0,L.jsx)("p",{className:"mb-0 desg-tag",children:"".concat(n()(a.createdAt).format("MM/DD/YY"))})]})]})]})};function Oe(e){let{card:a,patientId:t,rowData:l,index:o,setMainState:d,mainState:s,visitDate:r,getDetailedData:c,data:p=[]}=e;const[m,v]=(0,i.useState)({create:!1,update:!1,loading:!1,text:"",activeAudio:!1,parentDictation:null,continueDictation:null}),h=(0,i.useCallback)((()=>v((e=>({...e,create:!1,update:!1,continueDictation:null,activeAudio:null})))),[]),f=(0,i.useMemo)((()=>{let e=p||[];return s.showAll||(e=e.filter((e=>e.dictationDate===n()(r).format("YYYY-MM-DD")))),(0,_.yN)(e,"createdAt")}),[p,s.showAll,r]),y=(0,i.useCallback)((()=>{h()}),[h]),x=(0,i.useCallback)((async(e,a,i)=>{m.continueDictation?(e.id=m.continueDictation.id||null,delete e.note,delete e.mediaType,delete e.comment,delete e.label):e={...e,fileName:e.fileName,mediaType:e.mediaType,mediaUrl:e.mediaUrl},"create"===a?await(0,S.vX)({func:async(a,i)=>{try{const i={patientId:t,...e},l=m.continueDictation?await Y.A.attachmentUpdate({payload:i}):await Y.A.attachmentCreate({payload:i});1!==(null===l||void 0===l?void 0:l.status)||m.continueDictation?1===(null===l||void 0===l?void 0:l.status)&&m.continueDictation&&(d((e=>({...e,patientData:{...e.patientData,patientAttachments:e.patientData.patientAttachments.map((e=>e.id===l.data.id?{...e,mediaUrl:l.data.mediaUrl}:e))}}))),y()):d((e=>({...e,patientData:{...e.patientData,patientAttachments:[l.data,...e.patientData.patientAttachments]}}))),a(1)}catch(l){console.error(l),i(0)}},loading:"Creating File Data.",error:"Could not create File Data.",success:"File data created.",options:{id:"create-dictation"}}):"update"===a&&await(0,S.vX)({func:async(a,t)=>{try{const t=await Y.A.attachmentUpdate({payload:{...e,id:i}});d((e=>({...e,patientData:{...e.patientData,patientAttachments:e.patientData.patientAttachments.map((e=>e.id===t.data.id?{...e,...t.data}:e))}}))),a(1)}catch(l){console.error(l),t(0)}},loading:"Updating File Data.",error:"Could not update File Data.",success:"File Data updated.",options:{id:"update-dictation"}}),h()}),[h,t,d,m.continueDictation,y]),b=(0,i.useCallback)((async(e,a)=>{(0,U.vW)({title:"Are you sure about to delete the audio and attached content?",onDone:async()=>{await Y.A.attachmentDelete({payload:{id:e}}),d((a=>{var t;return{...a,patientData:{...a.patientData,patientAttachments:null===(t=a.patientData)||void 0===t?void 0:t.patientAttachments.filter((a=>a.id!==e))}}})),y()}})}),[d,y]),N=(0,i.useCallback)((async e=>{(0,U.vW)({title:"Are you sure about to delete the audio and attached content?",onDone:async()=>{await Y.A.attachmentDelete({payload:{id:e}}),d((a=>{var t;return{...a,patientData:{...a.patientData,patientAttachments:null===(t=a.patientData)||void 0===t?void 0:t.patientAttachments.filter((a=>a.id!==e))}}}))}})}),[d]),C=(0,i.useCallback)((e=>{v((a=>({...a,continueDictation:e})))}),[]),j=(0,i.useMemo)((()=>[{field:"actions",headerName:"Actions",type:"actions",minWidth:180,flex:1,getActions:e=>{let{row:a}=e;return[(0,L.jsx)(u.A,{size:"sm",onClick:()=>v((e=>({...e,activeAudio:a}))),children:"Play"}),(0,L.jsx)(u.A,{size:"sm",variant:"secondary",onClick:()=>C(a),children:"Continue Dictation"}),(0,L.jsx)(u.A,{size:"sm",variant:"secondary",onClick:()=>N(a.id),children:"Delete"})]}},{field:"date",headerName:"Date",minWidth:180,flex:0,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.dictationDate?n()(a.dictationDate).format("MM/DD/YY"):null})}},{field:"label",headerName:"Label",minWidth:180,flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)("div",{children:a.label?a.label:"-"})}},{field:"note",headerName:"Notes",minWidth:200,flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)("div",{children:a.note?a.note:"-"})}},{field:"comments",headerName:"Comments",minWidth:180,flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.comment})}}]),[N,C]),w=(0,i.useCallback)((async()=>{await(0,S.vX)({func:async(e,a)=>{try{await c(),d((e=>({...e,showAll:!e.showAll}))),e()}catch(t){console.error(t),a()}},loading:"Fetching dictations",success:"Successfully Fetch dictations",error:"Couldn't fetch dictations",options:{id:"read-dictation"}})}),[c,d]),A=(0,i.useCallback)((()=>d((e=>({...e,showAll:!e.showAll})))),[d]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(k.A,{className:"card p-2 m-1",children:[(0,L.jsx)("div",{className:"d-flex justify-content-between",children:(0,L.jsx)("div",{className:"accordion-button collapsed cursor-pointer","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapse-".concat(a.id,"-").concat(t),"aria-expanded":"false","aria-controls":"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),children:(0,L.jsx)("div",{className:"".concat(T.A.title," font-weight-bold"),children:"".concat(null!==l&&void 0!==l&&l.firstName?"".concat(null===l||void 0===l?void 0:l.firstName," ").concat(null!==l&&void 0!==l&&l.lastName?null===l||void 0===l?void 0:l.lastName:""," -"):"","  Dictation")})})}),(0,L.jsx)("div",{id:"panelsStayOpen-collapse-".concat(a.id,"-").concat(t),className:"accordion-collapse collapse show","aria-labelledby":"card-".concat(a.id),children:(0,L.jsxs)("div",{className:"accordion-body",children:[(0,L.jsxs)("div",{className:"buttons d-flex gap-10 my-2",children:[(0,L.jsx)(u.A,{variant:"primary",size:"sm",onClick:e=>v((e=>({...e,create:!0}))),children:"Add Dictation"}),(0,L.jsx)(u.A,{variant:"outline-secondary",size:"sm",onClick:s.showAll?A:w,children:s.showAll?"Reset":"Show All"})]}),(0,L.jsx)("div",{className:"my-2 cstm-mui-datagrid ".concat(null!==f&&void 0!==f&&f.length?"not_loading":"loading"),style:{maxHeight:"88vh",width:"100%",flexGlow:1},children:(0,L.jsx)(D.C,{columns:j,rows:null!==f&&void 0!==f&&f.length?f:[],autoHeight:!0,density:"compact",disableColumnFilter:!0,components:{LoadingOverlay:g.A,Footer:()=>(0,L.jsx)(L.Fragment,{})}})})]})}),(0,L.jsx)(we,{type:"audio",fieldName:"Dictation",showModal:Boolean(m.create||m.update||m.continueDictation),onSubmit:x,onCancel:h,mode:m.create||m.continueDictation?"create":m.update&&"update",continueDictation:m.continueDictation,updateData:m.update,visitDate:r}),(0,L.jsx)(Me,{activeAudio:m.activeAudio,onContinueDictation:C,onDeleteAttachment:b,updateFiles:y,onClose:()=>v((e=>({...e,activeAudio:!1})))})]})})}var ke=t(80854);const Te={loading:!1,patientData:{},id:0,showAll:!1};function Fe(e){let{visitDate:a,setPatientProfile:t,params:l,updatedDetailData:o,setMainState:d}=e;const[s,r]=(0,i.useState)(Te),c=(0,i.useCallback)((async e=>{r((e=>({...e,loading:!0})));let a=await(0,S.Qv)({body:e&&{dictationDate:{dateFrom:n()(e).format("YYYY-MM-DD"),dateTo:n()(e).format("YYYY-MM-DD")}},rest:{id:l.row.id},options:{populate:["patientAssign","patientTasks","patientAttachements","patientPaymentCode","patientGuardians","patientNote"]},findOne:!0});const t=await Y.A.list({payload:a});1!==(null===t||void 0===t?void 0:t.status)?r((e=>({...e,loading:!1}))):r((e=>({...e,loading:!1,patientData:t.data})))}),[l.row.id]);(0,i.useEffect)((()=>(c(a||null),()=>{r(Te)})),[c,a]),(0,i.useEffect)((()=>{o&&(r((e=>({...e,patientData:{...e.patientData,patientAttachments:e.patientData.patientAttachments?[o,...e.patientData.patientAttachments]:[o]}}))),d((e=>({...e,updatedDetailData:null}))))}),[o,d]);const u=(0,i.useMemo)((()=>{var e,i,n,o,d,u;return[{Order:4,Component:(0,L.jsx)(Oe,{type:"audio",rowData:l.row,patientId:s.patientData.id,getDetailedData:c,data:null===(e=s.patientData)||void 0===e||null===(i=e.patientAttachments)||void 0===i?void 0:i.filter((e=>{var a;return null===e||void 0===e||null===(a=e.mediaType)||void 0===a?void 0:a.includes("audio")})),mainState:s,visitDate:a,setMainState:r,card:{id:3},index:3})},{Order:2,Component:(0,L.jsx)(be,{patientId:s.patientData.id,rowData:l.row,data:s.patientData.patientTasks,setMainState:r,card:{id:1},index:1})},{Order:5,Component:(0,L.jsx)(ve,{type:"image",rowData:l.row,setPatientProfile:t,patientId:s.patientData.id,data:null===(n=s.patientData)||void 0===n||null===(o=n.patientAttachments)||void 0===o?void 0:o.filter((e=>{var a,t;return(null===e||void 0===e||null===(a=e.mediaType)||void 0===a?void 0:a.includes("image"))||(null===e||void 0===e||null===(t=e.mediaType)||void 0===t?void 0:t.includes("pdf"))})),setMainState:r,card:{id:2},index:2})},{Order:1,Component:(0,L.jsx)(q,{className:"w-100",rowData:l.row,patientId:s.patientData.id,setMainState:r,data:null===(d=s.patientData)||void 0===d?void 0:d.patientGuardians,card:{id:4},index:4})},{Order:3,Component:(0,L.jsx)(H,{className:"w-100",patientId:s.patientData.id,rowData:l.row,setMainState:r,data:null===s||void 0===s||null===(u=s.patientData)||void 0===u?void 0:u.patientNotes,card:{id:5},index:5})}]}),[s,l.row,t,a,c]);if(s.loading)return(0,L.jsx)("div",{className:"d-flex justify-content-between",children:(0,L.jsx)(O.h,{className:"login_loader"})});try{return(0,L.jsx)(ke.A,{children:(0,L.jsx)("div",{style:{maxHeight:"50vh",width:"100%"},children:u.map(((e,a)=>(0,L.jsx)(i.Fragment,{children:e.Component},a)))})})}catch(p){console.error(p)}}var Ee=t(84063),Re=t(9609),_e=t(86394);class Ue extends B.A{async list(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t,...P.M.API_TIMEOUT.L2};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/list",n,o)}async delete(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t,...P.M.API_TIMEOUT.L2};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/delete",n,o)}}const Ye=new Ue("/dischargeReason"),Le=e=>{let{state:a,setState:t,isDischarge:l,updateData:o}=e;const{scheduleInfo:d}=a,r=(0,i.useCallback)((e=>{let a={start:e,dateError:null};a.dischargeDate=n()(e).isBefore(n()().format("MM/DD/YY"))?n()().format():null,t((e=>({...e,scheduleInfo:{...e.scheduleInfo,...a}})))}),[t]),c=(0,i.useCallback)((e=>{let a={};a.dischargeDate=e?n()(e).format():null,t((e=>({...e,scheduleInfo:{...e.scheduleInfo,...a}})))}),[t]),{data:u}=(0,C.I)({queryKey:["/deschargeReason/list"],queryFn:async()=>(await Ye.list({})).data.map((e=>({id:e.id,label:e.title,value:e.title})))||[],keepPreviousData:!1,refetchOnWindowFocus:!1,staleTime:P.M.QUERY_STALE_TIME.L2,enabled:Boolean(null===d||void 0===d?void 0:d.dischargeDate)});return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(Re.A,{className:"text-color mt-4",style:{borderColor:"grey"},orientation:"left",children:"Patient Schedule"}),(0,L.jsxs)(X.A,{children:[(0,L.jsxs)($.A,{md:6,children:[(0,L.jsx)("label",{children:"Visit Date"}),(0,L.jsx)(s(),{onChange:e=>r(e),selected:null!==d&&void 0!==d&&d.start?n()(d.start).toDate():null,showTimeSelect:!0,popperPlacement:"auto",dateFormat:"MM/dd/yy h:mm aa",placeholderText:"Visit Date",className:"form-control search ".concat(d.dateError?"border-danger":""),wrapperClassName:"form-group",calendarClassName:"min-width-328",timeIntervals:15,timeCaption:"Time",autoFocus:null===d||void 0===d?void 0:d.dateError,disabled:l||o})]}),d.dischargeDate&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)($.A,{md:6,children:[(0,L.jsx)("label",{children:"Discharge Time"}),(0,L.jsx)(s(),{onChange:e=>c(e),selected:null!==d&&void 0!==d&&d.dischargeDate?n()(d.dischargeDate).toDate():null,showTimeSelect:!0,minDate:n()(d.start).toDate(),maxDate:n()().toDate(),popperPlacement:"auto",dateFormat:"MM/dd/yy h:mm aa",placeholderText:"Discharge Date",className:"form-control search ".concat(d.dateError?"border-danger":""),wrapperClassName:"form-group",calendarClassName:"min-width-328",timeIntervals:15,timeCaption:"Time",autoFocus:null===d||void 0===d?void 0:d.dateError,disabled:l,isClearable:!l})]}),(0,L.jsx)($.A,{md:6,children:(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{htmlFor:"dischargeReason",children:"Discharge reason"}),(0,L.jsx)(_e.A,{name:"dischargeReason",value:[a.scheduleInfo.dischargeReason],onChange:e=>{var a;const i=null!==e&&void 0!==e&&e.__isNew__||null===(a=u.find((a=>a.value===e.value)))||void 0===a?void 0:a.id;t((a=>({...a,scheduleInfo:{...a.scheduleInfo,reasonId:i,reasonType:e.value,dischargeReason:e?{label:e.label,value:e.value,isNew:null===e||void 0===e?void 0:e.__isNew__}:null}})))},options:u||[],menuPlacement:"auto",className:"basic-multi-select issue-multi-select_user-dropdown input-border",classNamePrefix:"select",placeholder:"Reason for discharge",isClearable:!0})]})}),(0,L.jsx)($.A,{md:6,children:(0,L.jsx)("div",{className:"form-group",children:(0,L.jsx)(Ce.A,{name:"reason",Label:"Reason",placeholder:"Reason",handleChange:e=>t((a=>({...a,scheduleInfo:{...a.scheduleInfo,reason:e.target.value}}))),value:(null===d||void 0===d?void 0:d.reason)||""})})})]})]}),(null===d||void 0===d?void 0:d.dateError)&&(0,L.jsx)("p",{className:"text-danger",children:d.dateError}),(0,L.jsx)(X.A,{children:(0,L.jsx)($.A,{children:(0,L.jsxs)("div",{className:"form-group w-100",children:[(0,L.jsx)("label",{htmlFor:"slotNote",className:"mb-1",children:"Note:"}),(0,L.jsx)("textarea",{type:"text",rows:3,placeholder:"Type Patient notes here",className:"form-control",value:d.note||"",onChange:e=>t((a=>({...a,scheduleInfo:{...a.scheduleInfo,note:e.target.value}})))})]})})})]})};var He=t(58594),ze=t(42904);const We=e=>{var a,t,l,n,d,s,r,c,u;let{state:p,setState:m,updateData:v,isDischarge:h}=e;const[f,g]=(0,i.useState)([]),[y,x]=(0,i.useState)([]),[b,N]=(0,i.useState)(!1);(0,i.useEffect)((()=>{(async(e,a)=>{if(h)return;N(!0);let t,i=[];v&&(t=v.patientSlots[0]&&v.patientSlots[0].facilityId);const l=await ze.A.list({payload:{options:{populate:["facilityProviderInfo","organizationInfo","facilityRooms"]}}}),n=await He.A.list({payload:{options:{populate:["providerInfoAssignfacility"]}}});t&&(i=l.data.find((e=>e.id===t)).facilityRooms.map((e=>({value:e.roomNumber,label:"".concat(e.roomNumber," (").concat(Boolean(e.facilityRoomAssign)?"Occupied":"Available",")")})))||[]),N(!1),x(i.length?i:null!==(e=p.facility)&&void 0!==e&&null!==(a=e.value)&&void 0!==a&&a.facilityRooms?p.facility.value.facilityRooms.map((e=>({value:e.roomNumber,label:"".concat(e.roomNumber," (").concat(Boolean(e.facilityRoomAssign)?"Occupied":"Available",")"),color:Boolean(null===e||void 0===e?void 0:e.facilityRoomAssign)?"#ccc":"#000"}))):[]),m((e=>({...e,facilityOptions:l.data.map((e=>({id:e.id,value:e,label:e.name})))||[]}))),g(n.data.map((e=>({id:e.id,value:e,label:e.name})))||[])})()}),[v,null===(a=p.facility)||void 0===a||null===(t=a.value)||void 0===t?void 0:t.facilityRooms,m,h]);const D=(0,i.useMemo)((()=>p.facility?f.filter((e=>e.value.facilityAssigns.map((e=>e.facilityId)).includes(p.facility.id))):[]),[p.facility,f]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(X.A,{children:(0,L.jsxs)($.A,{children:[(0,L.jsx)(Re.A,{className:"text-color align-items-center",style:{borderColor:"grey"},orientation:"left",children:"Attending Provider"}),(0,L.jsxs)(X.A,{children:[(0,L.jsxs)($.A,{md:6,className:"form-group",children:[(0,L.jsx)("label",{children:"Facility"}),(0,L.jsx)(o.Ay,{name:"facility",value:[p.facility],isLoading:b,onChange:e=>{m((a=>{var t,i,l,n,o,d;return{...a,facility:e,provider:(null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.id)===(null===(i=a.provider)||void 0===i||null===(l=i.value)||void 0===l||null===(n=l.facilityAssign)||void 0===n?void 0:n.facilityId)?a.provider:null,HCMDProvider:(null===e||void 0===e||null===(o=e.value)||void 0===o?void 0:o.facilityAssigns.filter((e=>e.isDefault)).map((e=>({id:"".concat(null===e||void 0===e?void 0:e.designation,"-").concat(null===e||void 0===e?void 0:e.id),designation:e.desiInfo||null,...e.providerInfo}))))||null,HCMDProviderOptions:null===e||void 0===e||null===(d=e.value)||void 0===d?void 0:d.facilityAssigns}}))},options:p.facilityOptions&&p.facilityOptions.length?p.facilityOptions:[],menuPlacement:"bottom",className:"basic-multi-select issue-multi-select_user-dropdown input-border ".concat(null!==(l=null===p||void 0===p||null===(n=p.facility)||void 0===n?void 0:n.autoSet)&&void 0!==l?l:""),classNamePrefix:"select",placeholder:"Select facility",isDisabled:h,isClearable:!0})]}),(0,L.jsxs)($.A,{md:6,className:"form-group",children:[(0,L.jsx)("label",{htmlFor:"duration",className:"mb-1",children:"Provider"}),(0,L.jsx)(_e.A,{name:"provider",value:[p.provider],onChange:e=>{var a,t,i,l,n,o;if(null!==e&&void 0!==e&&e.__isNew__&&null!==(a=p.facility)&&void 0!==a&&null!==(t=a.value)&&void 0!==t&&null!==(i=t.info)&&void 0!==i&&i.hasOwnProperty("owner")&&Boolean(null===(l=p.facility)||void 0===l||null===(n=l.value)||void 0===n||null===(o=n.info)||void 0===o?void 0:o.owner))return(0,M.Q)("Outside provider can't be created in HCMD facility. Please select another facility and try again.");m((a=>({...a,provider:e?{label:e.label,value:e.value,isNew:null===e||void 0===e?void 0:e.__isNew__}:null})))},options:D&&D.length?D:[],menuPlacement:"auto",className:"basic-multi-select issue-multi-select_user-dropdown input-border ".concat(null!==(d=null===p||void 0===p||null===(s=p.facility)||void 0===s?void 0:s.autoSet)&&void 0!==d?d:""),classNamePrefix:"select",placeholder:"Select provider",isClearable:!0,isLoading:b,isDisabled:b||!p.facility||h}),p.facility&&!(null!==(r=p.facility)&&void 0!==r&&r.autoSet)&&(0,L.jsx)("small",{className:"text-success",children:"Set as per previous slot of the patient"}),!p.facility&&(0,L.jsx)("small",{children:"Please select facility first"})]})]}),(0,L.jsxs)(X.A,{children:[(0,L.jsxs)($.A,{md:6,children:[(0,L.jsx)("label",{children:"Location"}),(0,L.jsx)("input",{type:"text",className:"form-control",placeholder:"Location",disabled:!0,value:null!==(c=p.facility)&&void 0!==c&&null!==(u=c.value)&&void 0!==u&&u.location?p.facility.value.location:""})]}),(0,L.jsxs)($.A,{md:6,children:[(0,L.jsx)("label",{children:"Room Number"}),(0,L.jsx)(_e.A,{name:"roomNumber",value:[p.scheduleInfo.roomNumber],onChange:e=>{m((a=>({...a,scheduleInfo:{...a.scheduleInfo,roomNumber:e?{label:e.label,value:e.value,isNew:null===e||void 0===e?void 0:e.__isNew__}:null}})))},options:y,menuPlacement:"auto",className:"basic-multi-select issue-multi-select_user-dropdown input-border",classNamePrefix:"select",placeholder:"Room Number",isDisabled:h,isClearable:!0})]})]})]})})})};var Ke=t(38467),Be=t(53874);function Ge(e){let{setMainState:a,mainState:t}=e;const{consultancyProvider:l}=t,[n,o]=(0,i.useState)({create:!1,update:!1}),d=(0,i.useCallback)((()=>o((e=>({...e,create:!1,update:!1})))),[]),s=(0,i.useCallback)((e=>{a((a=>({...a,consultancyProvider:a.consultancyProvider.filter((a=>a.id!==e.id))})))}),[a]),r=(0,i.useCallback)((e=>{a((a=>({...a,consultancyProvider:[e,...a.consultancyProvider]}))),d()}),[a,d]),c=(0,i.useMemo)((()=>[{field:"name",headerName:"Name",minWidth:50,headerAlign:"center",align:"center",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.name?a.name:"-"})}},{field:"speciality",headerName:"Speciality",minWidth:50,headerAlign:"center",align:"center",renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.speciality?a.speciality:"-"})}},{field:"faxNumber",headerName:"Fax Number",minWidth:50,headerAlign:"center",align:"center",renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.faxNumber?a.faxNumber:"-"})}},{field:"contactNumber",headerName:"Contact Number",minWidth:50,headerAlign:"center",align:"center",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.phone?a.phone:"-"})}},{field:"actions",type:"actions",headerName:"Actions",minWidth:180,getActions:e=>{let{row:a}=e;return[(0,L.jsx)(y.Ah,{Icon:Ke.A,size:"small",tooltip:"Call"}),(0,L.jsx)(y.Jx,{onClick:()=>s(a)})]}}]),[s]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(Re.A,{className:"text-color mt-4",style:{borderColor:"grey"},orientation:"left",children:"Consultancy Provider"}),(0,L.jsx)("div",{className:"cstm-mui-datagrid ".concat(null!==l&&void 0!==l&&l.length?"not_loading":"loading"),style:{maxHeight:"88vh",width:"100%",flexGrow:1},children:(0,L.jsx)(D.C,{rows:l&&null!==l&&void 0!==l&&l.length?l:[],columns:c,autoHeight:!0,disableColumnFilter:!0,disableVirtualization:!0,components:{LoadingOverlay:g.A,Footer:()=>null}})}),(0,L.jsx)(u.A,{className:"mt-1",variant:"primary",onClick:()=>o((e=>({...e,create:!0}))),children:"Add Provider"}),(0,L.jsx)(Ve,{fieldName:"Consultancy Provider",showModal:Boolean(n.create||n.update),onSubmit:r,onCancel:d,mode:n.create?"create":n.update&&"update",updateData:n.update,consultancyProvider:l})]})}const Ve=e=>{let{showModal:a,onSubmit:t,onCancel:l,mode:n="create",updateData:d,fieldName:s="field",consultancyProvider:r}=e;const[c,p]=(0,i.useState)(),[m,v]=(0,i.useState)(!1),[h,f]=(0,i.useState)([]);(0,i.useEffect)((()=>{(async()=>{if(!a)return;v(!0);const e={query:{ownProvider:!1,designationId:(await(0,Be.wE)(P.M.DESIGNATION_KEY.PROVIDER,"selectable")).id||void 0},options:{sort:[["name","asc"]]}},t=await He.A.list({payload:e});f(t.data.map((e=>({id:e.id,value:e,label:e.name})))),v(!1)})()}),[a]);const g=(0,i.useMemo)((()=>{let e=h;const a=r.map((e=>e.id));return e=e.filter((e=>!a.includes(e.id))),e}),[h,r]);return(0,L.jsx)(E.A,{header:(0,L.jsx)(L.Fragment,{children:"update"===n?"Edit "+s:"Add "+s}),toggle:l,show:a,body:a&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{htmlFor:"addHCMDprovider",children:"Provider"}),(0,L.jsx)(o.Ay,{name:"addHCMDprovider",value:[c],onChange:e=>p(e),cacheOptions:[],autoFocus:!0,defaultOptions:!0,classNamePrefix:"select",placeholder:"Select provider",menuPlacement:"auto",options:g,isLoading:m,className:"basic-multi-select issue-multi-select_user-dropdown input-border"})]}),(0,L.jsx)(u.A,{onClick:()=>t(c.value),disabled:!c,children:"Add"})]})})};function qe(e){let{mainState:a,setMainState:t}=e;const{nextOfKin:l={}}=a,[n,o]=(0,i.useState)({create:!1,update:!1}),d=(0,i.useMemo)((()=>[{field:"name",headerName:"Contact Name",minWidth:50,headerAlign:"center",align:"center",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.name?a.name:"-"})}},{field:"relation",headerName:"Relation",minWidth:50,headerAlign:"center",align:"center",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.relation?a.relation:"-"})}},{field:"contactNumber",headerName:"Contact",minWidth:50,headerAlign:"center",align:"center",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.contactNumber?a.contactNumber:"-"})}},{field:"typeOfNumber",headerName:"Contact Type",minWidth:50,headerAlign:"center",align:"center",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.typeOfNumber?a.typeOfNumber:"-"})}},{field:"actions",type:"actions",headerName:"Actions",getActions:e=>[(0,L.jsx)(y.or,{onClick:()=>o((a=>({...a,update:e.row})))}),(0,L.jsx)(y.Jx,{onClick:()=>t((a=>({...a,nextOfKin:a.nextOfKin.filter((a=>a.id!==e.id))})))})]}]),[t]),s=(0,i.useCallback)((()=>o((e=>({...e,create:!1,update:!1})))),[]),r=(0,i.useCallback)((e=>{n.update?t((a=>({...a,nextOfKin:a.nextOfKin.map((a=>a.id===e.id?{...a,...e}:a))}))):t((a=>({...a,nextOfKin:[...a.nextOfKin,e]})))}),[n.update,t]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(Re.A,{className:"text-color mt-4",style:{borderColor:"grey"},orientation:"left",children:"Next of Kin"}),(0,L.jsx)("div",{className:"cstm-mui-datagrid ".concat(null!==l&&void 0!==l&&l.length?"not_loading":"loading"),style:{maxHeight:"88vh",width:"100%",flexGrow:1},children:(0,L.jsx)(D.C,{rows:l&&l.length?l:[],columns:d,autoHeight:!0,disableColumnFilter:!0,disableVirtualization:!0,components:{Footer:()=>(0,L.jsx)(L.Fragment,{})}})}),(0,L.jsx)(u.A,{className:"mt-1",variant:"primary",onClick:()=>o((e=>({...e,create:!0}))),children:"Add Relative"}),(0,L.jsx)(J,{fieldName:"Relative",showModal:Boolean(n.create||n.update),onSubmitSuccess:r,onCancel:s,mode:n.create?"create":n.update&&"update",updateData:n.update,directSubmit:!0})]})}var Je=t(12624);function Xe(e){let{mainState:a,setMainState:t}=e;const{HCMDProvider:l,HCMDProviderOptions:n}=a,[o,d]=(0,i.useState)({create:!1,update:!1}),s=(0,i.useCallback)((()=>d((e=>({...e,create:!1,update:!1})))),[]),r=(0,i.useCallback)((e=>{t((a=>({...a,HCMDProvider:a.HCMDProvider.filter((a=>a.id!==e.id))})))}),[t]),c=(0,i.useCallback)((e=>{t((a=>({...a,HCMDProvider:[e,...a.HCMDProvider]}))),s()}),[t,s]),p=(0,i.useMemo)((()=>[{field:"name",headerName:"Name",minWidth:50,headerAlign:"center",align:"center",flex:1,renderCell:e=>{var a;let{row:t}=e;const i=(0,Be.L9)(t.designation.key);return(0,L.jsxs)("div",{className:"d-flex gap-10",children:[(0,L.jsx)("div",{children:t.name?t.name:"-"}),(null===(a=t.designation)||void 0===a?void 0:a.key)&&i&&(0,L.jsx)("div",{className:"desg-tag",children:i})]})}},{field:"speciality",headerName:"Speciality",minWidth:110,headerAlign:"center",align:"center",renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.speciality?a.speciality:"-"})}},{field:"faxNumber",headerName:"Fax Number",minWidth:110,headerAlign:"center",align:"center",renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.faxNumber?a.faxNumber:"-"})}},{field:"contactNumber",headerName:"Contact Number",minWidth:110,headerAlign:"center",align:"center",flex:1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.phone?a.phone:"-"})}},{field:"actions",type:"actions",headerName:"Actions",getActions:e=>{let{row:a}=e;return[(0,L.jsx)(y.Ah,{Icon:Ke.A,size:"small",tooltip:"Call"}),(0,L.jsx)(y.Jx,{onClick:()=>r(a)})]}}]),[r]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(Re.A,{className:"text-color mt-4",style:{borderColor:"grey"},orientation:"left",children:"HCMD Provider"}),(0,L.jsx)("div",{className:"cstm-mui-datagrid ".concat(null!==l&&void 0!==l&&l.length?"not_loading":"loading"),style:{maxHeight:"88vh",width:"100%",flexGrow:1},children:(0,L.jsx)(D.C,{rows:l&&null!==l&&void 0!==l&&l.length?l:[],columns:p,autoHeight:!0,disableColumnFilter:!0,disableVirtualization:!0,components:{LoadingOverlay:g.A,Footer:()=>(0,L.jsx)(L.Fragment,{})}})}),(0,L.jsx)(u.A,{className:"mt-1",variant:"primary",onClick:()=>d((e=>({...e,create:!0}))),children:"Add Provider"}),(0,L.jsx)($e,{fieldName:"HCMD Provider",showModal:Boolean(o.create||o.update),onSubmit:c,onCancel:s,mode:o.create?"create":o.update&&"update",updateData:o.update,HCMDProvider:l,HCMDProviderOptions:n,mainState:a,setMainState:t})]})}const Qe=["MD","NP"],$e=e=>{var a;let{showModal:t,onSubmit:l,onCancel:n,mode:d="create",fieldName:s="field",HCMDProvider:r,HCMDProviderOptions:c,mainState:p,setMainState:m}=e;const[v,h]=(0,i.useState)(),[f,g]=(0,i.useState)(Qe[0]);(0,i.useEffect)((()=>{(async()=>{const e=p.facilityOptions.find((e=>{var a;return e.id===(null===(a=p.facility)||void 0===a?void 0:a.id)})),a={query:{id:null===e||void 0===e?void 0:e.id},options:{populate:["facilityProviderInfo","organizationInfo"]},findOne:!0};let t=await ze.A.list({payload:a});t=t.data.facilityAssigns.map((e=>({...e,designation:e.desiInfo}))),m((e=>({...e,HCMDProviderOptions:t})))})()}),[null===(a=p.facility)||void 0===a?void 0:a.id,p.facilityOptions,m]);const y=(0,i.useMemo)((()=>{let e=[];if(c&&c.length){const a=(null===r||void 0===r?void 0:r.map((e=>e.id)))||[];e=c.filter((e=>!a.includes(e.providerId||e.userId))).map((e=>({id:e.providerInfo.id,label:e.providerInfo.name,value:{...e.providerInfo,designation:e.desiInfo||null}}))).filter((e=>{var a;return(0,Be.L9)(null===(a=e.value.designation)||void 0===a?void 0:a.key)===f}))}return e}),[r,c,f]);return(0,L.jsx)(E.A,{header:(0,L.jsx)(L.Fragment,{children:"update"===d?"Edit "+s:"Add "+s}),toggle:n,show:t,body:t&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"form-group d-flex gap-10 align-items-center mb-1",children:[(0,L.jsx)("label",{htmlFor:"designation",className:"mb-0",children:"Designation: "}),(0,L.jsx)(Je.A,{className:"outline-none",style:{background:"#665fde"},unCheckedChildren:"NP",checkedChildren:"MD",checked:f===Qe[0],onChange:e=>g((e=>e===Qe[0]?Qe[1]:Qe[0]))})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{htmlFor:"addHCMDprovider",children:"Provider: "}),(0,L.jsx)(o.Ay,{options:y,className:"basic-multi-select issue-multi-select_user-dropdown input-border",classNamePrefix:"select",name:"addHCMDprovider",value:[v],onChange:e=>h(e),cacheOptions:[],placeholder:"Select provider",menuPlacement:"auto",defaultOptions:!0,autoFocus:!0,isClearable:!0})]}),(0,L.jsx)(u.A,{onClick:()=>l(v.value),disabled:!v,children:"Add"})]})})};var Ze=t(53536),ea=t(46470),aa=t(17195),ta=t.n(aa);t(15935);function ia(e){let{state:a,setState:t,updateData:l}=e;const{patientData:d,isPatientloading:r}=a,c=(0,i.useRef)();(0,i.useEffect)((()=>{c.current.focus()}),[]);const u=(0,i.useCallback)((e=>{const{value:a,name:i}=e.target;if("lastName"===i&&a){const e=()=>{var e,l,n,o;let d=(null===a||void 0===a?void 0:a.value)||null;null!==a&&void 0!==a&&a.__isNew__&&(d=(null===(e=d)||void 0===e?void 0:e.charAt(0).toUpperCase())+(null===(l=d)||void 0===l?void 0:l.slice(1)));const s=!(null===(n=d)||void 0===n||null===(o=n.patientSlots)||void 0===o||!o.length)&&d.patientSlots[0];t((e=>{var t,l;const n=s&&d.patientAssigns.find((e=>e.userId===s.providerId));let o={...e,nextOfKin:(null===a||void 0===a||null===(t=a.value)||void 0===t?void 0:t.patientGuardians)||e.nextOfKin,facility:null!==(l=d)&&void 0!==l&&l.facilityInfo?{id:d.facilityInfo.id,label:d.facilityInfo.name,value:d.facilityInfo,autoSet:"auto-set-field"}:{...e.facility,autoSet:null},provider:n?{id:n.userId,label:n.usersPatient.name,value:{id:n.userId},autoSet:"auto-set-field"}:{...e.provider,autoSet:null}};return e.isNewPatient&&null!==a&&void 0!==a&&a.__isNew__&&(o={...o}),a?null!==a&&void 0!==a&&a.__isNew__?null!==a&&void 0!==a&&a.__isNew__?{...o,patientData:{...e.patientData,[i]:d},isNewPatient:!0}:o:{...o,patientData:{...d},isNewPatient:!1}:{...o,patientData:{},isNewPatient:!0}}))};a&&Object.keys(d).length&&(d.firstName||d.middleName)?(0,U.vW)({title:"Are you sure to change the patient?",content:"Once you confirm the entered patient data would be changed.",onDone:e}):e()}else t((e=>({...e,patientData:{...e.patientData,[i]:a}})))}),[t,d]),p=(0,i.useCallback)((e=>{if("Tab"===e.key){const e=c.current.select;if(e){const a=e.state.focusedOption;a&&u({target:{name:"lastName",value:a}})}}}),[u]),m=(0,i.useCallback)((e=>{const{value:a}=e.target;e.target.value=a?a.charAt(0).toUpperCase()+a.slice(1):"",u(e)}),[u]),v=(0,Ze.debounce)(((e,a)=>{la(e).then((e=>{1===e.status&&a(e.data.map((e=>({id:e.id,value:e,label:(0,_.SQ)(e.firstName+" "+e.lastName)}))))}))}),1e3);return(0,L.jsxs)(X.A,{children:[(0,L.jsx)($.A,{xs:12,children:(0,L.jsx)(Re.A,{className:"text-color mt-4",style:{borderColor:"grey"},orientation:"left",children:"Patient Details"})}),(0,L.jsxs)($.A,{md:6,className:"form-group mb-0",children:[(0,L.jsxs)("label",{htmlFor:"firstName",children:["Lastname",(0,L.jsx)("small",{className:"text-danger",children:"*"})]}),(0,L.jsx)(ea.A,{defaultOptions:[],ref:c,classNamePrefix:"select",className:"basic-single",placeholder:"Last name",loadOptions:v,isLoading:r,isClearable:!0,value:d.lastName?[{label:d.lastName,value:d.lastName}]:null,onKeyDown:p,onChange:e=>{u({target:{name:"lastName",value:e}})}})]}),(0,L.jsx)($.A,{md:6,className:"form-group mb-0",children:(0,L.jsx)(Ce.A,{Label:"Firstname",placeholder:"First name",name:"firstName",handleChange:u,formgroupClass:"",isRequired:!1,type:"text",error:"",value:d.firstName,inputProps:{onBlurCapture:m}})}),(0,L.jsx)($.A,{md:6,className:"form-group mb-0",children:(0,L.jsx)(Ce.A,{Label:"Middlename",placeholder:"Middle name",name:"middleName",handleChange:u,formgroupClass:"",isRequired:!1,type:"text",error:"",value:d.middleName,inputProps:{onBlurCapture:m}})}),(0,L.jsxs)($.A,{md:6,className:"form-group mb-0",children:[(0,L.jsx)("label",{htmlFor:"Phone",children:"Phone"}),(0,L.jsx)(ta(),{value:(null===d||void 0===d?void 0:d.phone)||"",inputClass:"w-100",placeholder:"phone",label:"phone",name:"phone",onChange:e=>u({target:{name:"phone",value:e}}),country:"us"})]}),(0,L.jsx)($.A,{md:6,className:"form-group mb-0",children:(0,L.jsx)(Ce.A,{Label:"Insurance",placeholder:"Insurance",name:"insurance",handleChange:u,formgroupClass:"",isRequired:!1,type:"text",error:"",value:d.insurance})}),(0,L.jsx)($.A,{md:6,className:"form-group mb-0",children:(0,L.jsx)(Ce.A,{Label:"SSN",placeholder:"SSN",name:"SSN",handleChange:u,formgroupClass:"",isRequired:!1,type:"text",error:"",value:d.SSN})}),(0,L.jsxs)($.A,{md:6,className:"form-group mb-0",children:[(0,L.jsx)("label",{htmlFor:"DOB",children:"DOB"}),(0,L.jsx)(s(),{className:"form-control",placeholderText:"DOB",selected:d.DOB?n()(d.DOB).toDate():null,onChange:e=>u({target:{name:"DOB",value:e}})})]}),(0,L.jsx)($.A,{md:6,className:"form-group mb-0",children:(0,L.jsx)(Ce.A,{Label:"City",placeholder:"City",name:"city",handleChange:u,formgroupClass:"",isRequired:!1,type:"text",error:"",value:d.city})}),(0,L.jsx)($.A,{md:6,className:"form-group mb-0",children:(0,L.jsx)(Ce.A,{Label:"Zip",placeholder:"Zip",name:"zip",handleChange:u,formgroupClass:"",isRequired:!1,type:"text",error:"",value:d.zip})}),(0,L.jsxs)($.A,{md:6,className:"form-group mb-2",children:[(0,L.jsx)("label",{htmlFor:"gender",children:"Gender"}),(0,L.jsx)(o.Ay,{className:"basic-single",classNamePrefix:"select",placeholder:"Select gender...",name:"gender",value:[d.gender?P.M.GENDER_TYPE.find((e=>e.value===d.gender)):null],options:P.M.GENDER_TYPE,onChange:e=>u({target:{name:"gender",value:e.value}}),menuPlacement:"auto"})]}),(0,L.jsxs)($.A,{md:6,className:"form-group mb-2",children:[(0,L.jsx)("label",{htmlFor:"maritalStatus",children:"Marital status"}),(0,L.jsx)(o.Ay,{className:"basic-single",classNamePrefix:"select",placeholder:"Marital status...",name:"maritalStatus",value:[d.maritalStatus?P.M.MARITAL_TYPE.find((e=>e.value===d.maritalStatus)):null],options:P.M.MARITAL_TYPE,onChange:e=>u({target:{name:"maritalStatus",value:e.value}}),menuPlacement:"auto"})]}),(0,L.jsx)($.A,{md:6,className:"form-group mb-0",children:(0,L.jsx)(Ce.A,{Label:"Medical Record Number",placeholder:"Medical Record Number",name:"medicalRecordNumber",handleChange:u,formgroupClass:"",isRequired:!1,type:"text",error:"",value:d.medicalRecordNumber})}),(0,L.jsxs)($.A,{md:6,className:"form-group mb-0",children:[(0,L.jsx)("label",{htmlFor:"Admit-date",children:"Admit Date"}),(0,L.jsx)(s(),{className:"form-control",placeholderText:"Date of Admit",selected:d.admitDate?n()(d.admitDate).toDate():null,onChange:e=>u({target:{name:"admitDate",value:e}})})]})]})}const la=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const a=await(0,S.Qv)({options:{populate:["patientGuardians","patientAssign","lastAllocatedSlot","facilityInfo"]},keys:["firstName","lastName","middleName"],value:e});return await Y.A.list({payload:a})};class na extends B.A{async create(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t,...P.M.API_TIMEOUT.L2};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/create",n,o)}async list(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t,...P.M.API_TIMEOUT.L2};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/list",n,o)}async update(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/update",n,o)}async delete(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/delete",n,o)}async dischargeUpdate(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/discharge/update",n,o)}async transferPatient(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/transferpatient",n,o)}}class oa extends B.A{async secondarypaymentcodeUpdate(e){let{payload:a={},config:t={headers:{}},headers:i={},encrypted:l=!0}=e,n=a,o={...t};return n=(0,K.C)({data:n,payload:a,encrypted:l,configuration:o,headers:i}),this.api.post("/update",n,o)}}const da=new na("/patientslot"),sa=new oa("/secondarypaymentcode"),ra=da,ca={patientError:null,provider:null,facility:null,location:null,patientData:{},consultancyProvider:[],facilityOptions:[],HCMDProvider:[],nextOfKin:[],scheduleInfo:{roomNumber:null,duration:15,note:"",start:n()().toDate(),appointmentType:P.M.APPOINTMENT_TYPE.PATIENT.value},isPatientloading:!1,isNewPatient:!0},ua=e=>{var a,t,i,l,o;let{defaultState:d,updateData:s}=e;const{facilityInfo:r,patientAssigns:c,patientSlots:u,...p}=s,m=s.patientSlots&&s.patientSlots[0]||null,v=null!==m&&void 0!==m&&m.facilitySlotInfo?{id:null===m||void 0===m?void 0:m.facilitySlotInfo.id,value:null===m||void 0===m?void 0:m.facilitySlotInfo,label:null===m||void 0===m?void 0:m.facilitySlotInfo.name}:null,h=c.filter((e=>e.type===P.M.PROVIDER_TYPE.HCMD_PROVIDER)).map((e=>{var a;return{...e.usersPatient,designation:(null===(a=e.usersPatient.facilityAssigns.find((e=>{var a;return(null===e||void 0===e||null===(a=e.facility)||void 0===a?void 0:a.id)===(null===v||void 0===v?void 0:v.id)})))||void 0===a?void 0:a.desiInfo)||""}})),f=c.filter((e=>e.type===P.M.PROVIDER_TYPE.CONSULTANCY_PROVIDER)).map((e=>e.usersPatient)),g=(null===(a=c.find((e=>e.type===P.M.PROVIDER_TYPE.ATTENDEE)))||void 0===a?void 0:a.usersPatient)||null,y=g?{label:g.name,value:g}:null,x={...d.scheduleInfo,roomNumber:null!==m&&void 0!==m&&m.roomNumber?{label:m.roomNumber,value:m.roomNumber}:null,start:n()(m.start).toDate(),dischargeDate:null===m||void 0===m?void 0:m.dischargeDate,note:m.title,dischargeReason:(null===m||void 0===m||null===(t=m.patientDischarge)||void 0===t?void 0:t.reasonType)&&{label:null===m||void 0===m||null===(i=m.patientDischarge)||void 0===i?void 0:i.reasonType,value:null===m||void 0===m||null===(l=m.patientDischarge)||void 0===l?void 0:l.reasonType}||[],reason:(null===m||void 0===m||null===(o=m.patientDischarge)||void 0===o?void 0:o.reason)||""};return{...d,patientData:{...p,patientSlot:m},facility:v,HCMDProvider:h,consultancyProvider:f,provider:y,scheduleInfo:x,isNewPatient:!1}};function pa(e){var a;let{onCancel:t,onSubmit:l,updateData:n}=e;const[o,d]=(0,i.useState)(n?ua({defaultState:ca,updateData:n}):ca),s=(0,i.useRef)(),r=(0,i.useRef)();(0,i.useEffect)((()=>{null!==n&&void 0!==n&&n.id&&(async()=>{let e=await(0,S.Qv)({rest:{id:n.id},options:{populate:["patientGuardians"]},findOne:!0});const a=await Y.A.list({payload:e});1===(null===a||void 0===a?void 0:a.status)&&d((e=>({...e,nextOfKin:a.data.patientGuardians||[]})))})()}),[null===n||void 0===n?void 0:n.id]);const c=(0,i.useMemo)((()=>{const[e]=(null===n||void 0===n?void 0:n.patientSlots)||[];return Boolean(e&&e.discharge&&e.patientDischarge)}),[null===n||void 0===n?void 0:n.patientSlots]),p=(0,i.useCallback)((async()=>{var e,a,i,d,u,p,m,v,h,f,g,y,x,b;if(!o.patientData.lastName)return null===(x=s.current)||void 0===x||x.scrollIntoView({behavior:"smooth"}),(0,M.Q)("Please fill patient data");if(!o.facility&&(null===(b=r.current)||void 0===b||b.scrollIntoView({behavior:"smooth"}),!o.facility))return(0,M.Q)("Please assign facility");let N={patientInfo:o.isNewPatient?{...o.patientData,firstName:o.patientData.firstName}:{...o.patientData,id:o.patientData.id},scheduleInfo:{...o.scheduleInfo,roomNumber:(null===(e=o.scheduleInfo)||void 0===e||null===(a=e.roomNumber)||void 0===a?void 0:a.value)||null,isNewRoom:null===(i=o.scheduleInfo)||void 0===i||null===(d=i.roomNumber)||void 0===d?void 0:d.isNew},patientAssigns:null!==o&&void 0!==o&&o.provider?[{type:P.M.PROVIDER_TYPE.ATTENDEE,value:null===o||void 0===o||null===(u=o.provider)||void 0===u||null===(p=u.value)||void 0===p?void 0:p.id,name:null!==o&&void 0!==o&&null!==(m=o.provider)&&void 0!==m&&m.isNew?null===o||void 0===o||null===(v=o.provider)||void 0===v?void 0:v.value:void 0,isNew:(null===o||void 0===o||null===(h=o.provider)||void 0===h?void 0:h.isNew)||void 0}]:[],isPatientExist:!o.isNewPatient,isDischarge:c};N.scheduleInfo.dischargeReason&&(N.scheduleInfo.reasonType=N.scheduleInfo.dischargeReason.value,delete N.scheduleInfo.dischargeReason),null!==(f=o.nextOfKin)&&void 0!==f&&f.length&&(N.nextOfKin=o.nextOfKin),null!==(g=o.HCMDProvider)&&void 0!==g&&g.length&&(N.patientAssigns=[...N.patientAssigns,...o.HCMDProvider.map((e=>{var a;return{value:e.id,type:P.M.PROVIDER_TYPE.HCMD_PROVIDER,designationId:null===(a=e.designation)||void 0===a?void 0:a.id}}))]),null!==(y=o.consultancyProvider)&&void 0!==y&&y.length&&(N.patientAssigns=[...N.patientAssigns,...o.consultancyProvider.map((e=>({value:e.id,type:P.M.PROVIDER_TYPE.CONSULTANCY_PROVIDER})))]),n&&(N.scheduleInfo.id=n.patientSlots&&n.patientSlots[0].id||void 0),N.scheduleInfo.facilityId=o.facility.id||void 0,N.isUpdate=Boolean(n);const D=await Y.A.createPatientSchedule({payload:N});1===(null===D||void 0===D?void 0:D.status)?(l(),t()):3===D.status?(0,U.vW)({title:(0,L.jsx)("div",{dangerouslySetInnerHTML:{__html:D.message}}),content:"",onDone:async()=>{await ra.dischargeUpdate({payload:D.patientInfo}),(0,M.T)("Patient discharge successfully")},onCancel:()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},okText:"Discharge",cancelText:"Select Room"}):2===D.status&&(0,M.Q)((0,L.jsx)("div",{dangerouslySetInnerHTML:{__html:D.message}}))}),[o,l,t,n,c]);return(0,L.jsx)(E.A,{header:n?'Edit Schedule for patient "'.concat(n.lastName,'"'):"Schedule New Patient",Modalprops:{className:"text-color"},show:!0,toggle:()=>t(),size:"lg",bodyProps:{style:{overflow:"auto",maxHeight:window.innerWidth<767?"calc(100vh - 100px)":"calc(100vh - 180px)"}},body:(0,L.jsxs)(ke.A,{children:[(0,L.jsx)("div",{ref:r}),(0,L.jsx)(We,{setState:d,state:o,updateData:n,isDischarge:c}),(0,L.jsx)("div",{ref:s}),(0,L.jsx)(ia,{setState:d,state:o,updateData:n}),(0,L.jsx)(Ge,{setMainState:d,mainState:o}),(0,L.jsx)(Xe,{setMainState:d,mainState:o}),(0,L.jsx)(qe,{setMainState:d,mainState:o}),(0,L.jsx)(Le,{setState:d,state:o,updateData:n,isDischarge:c})]}),footer:(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)("div",{className:"d-flex gap-10 align-items-center",children:[n&&(null===n||void 0===n||null===(a=n.patientSlots[0])||void 0===a?void 0:a.discharge)&&(0,L.jsx)("div",{children:(0,L.jsx)(Ee.A,{pill:!0,bg:"danger",className:"text-white font-weight-normal",children:"Discharged"})}),(0,L.jsx)(u.A,{variant:"secondary",onClick:()=>t(),children:"Cancel"}),(0,L.jsx)(u.A,{onClick:p,children:n?"Update":"Submit"})]})})})}const ma=()=>[{name:"provider",label:"Assign to Provider",valueKey:"provider",value:"",placeholder:"Select Provider",type:"select",validationType:"array",validations:[{type:"required",params:["Provider is required"]}],options:[],isEditable:!0,pluginConfiguration:{}},{name:"transferType",label:"Transfer type",valueKey:"transferType",value:"permenant",type:"radio",validationType:"string",validations:[{type:"required",params:["Type should be mentioned"]}],isEditable:!0,options:[{label:"Permenant",value:"permenant"},{label:"Temporary",value:"temporary"}]},{name:"duration",label:"Duration Period (In days)",valueKey:"duration",value:"",type:"number",validationType:"number",validations:[],isEditable:!0,note:"Don't require in case of permenant transfer"},{name:"reasonOfTransfer",label:"Reason of Transfer",valueKey:"reasonOfTransfer",value:"",type:"textarea",validationType:"string",validations:[],isEditable:!0,pluginConfiguration:{rows:3}}];function va(e){let{toggleTransferModel:a,state:t,data:l,providers:n=[]}=e;const[o,d]=(0,i.useState)({facility:null,provider:null,selectedRows:[],isLoading:!1}),s=(0,i.useMemo)((()=>ma()),[]),{formJSON:r}=(0,i.useMemo)((()=>{var e;const a=l.filter((e=>t.selectionModel.includes(e.id)));if(!a.length)return[];const[i]=a,o=(null===(e=i.patientSlots[0])||void 0===e?void 0:e.facilitySlotInfo)||null;let r=n;o&&(r=r.filter((e=>e.value.facilityAssigns.map((e=>e.facilityId)).includes(o.id)))),r=r.map((e=>({...e,value:e.id}))),d((e=>({...e,facility:o,selectedRows:a})));return{formJSON:s.map((e=>("provider"===e.name&&(e.options=r),e)))}}),[s,l,t.selectionModel,n]);return(0,L.jsx)(E.A,{header:"Transfer Patient",toggle:a,show:t.transferModel,body:(0,L.jsx)(L.Fragment,{children:t.transferModel&&!!t.selectionModel.length&&(0,L.jsx)(R.A,{className:"m-0",FormButtons:()=>(0,L.jsxs)("div",{className:"d-flex justify-content-end gap-10",children:[(0,L.jsx)(u.A,{variant:"secondary",onClick:a,children:"Cancel"}),(0,L.jsx)(u.A,{type:"submit",variant:"primary",children:"Save"})]}),resetOnSubmit:!1,dataFields:r,onSubmit:async e=>{var t,i;if(null===(t=e.provider)||void 0===t||!t.length)return(0,M.Q)("Please assign provider");e.hasOwnProperty("provider")&&null!==(i=e.provider)&&void 0!==i&&i.length&&(e.providerId=e.provider[0].value,delete e.provider),e.type=e.transferType,"permenant"===e.type&&e.duration&&(e.duration=0),e.patientInfo=o.selectedRows.map((e=>({patientId:e.id,patientSlotId:e.patientSlots[0].id,providerId:e.patientSlots[0].providerId}))),await(async e=>{try{d((e=>({...e,isLoading:!0}))),await ra.transferPatient({payload:e}),d((e=>({...e,isLoading:!1}))),a(!0)}catch(t){console.error(t),d((e=>({...e,isLoading:!1})))}})(e)}})})})}const ha=e=>{let{cbDelete:a}=e;return[{name:"dischargeDate",label:"Date of discharge",valueKey:"dischargeDate",value:"",type:"date",validationType:"string",validations:[],isEditable:!0,pluginConfiguration:{isDateRange:!1}},{name:"reasonType",label:"Select Reason",valueKey:"reasonType",value:"",type:"select",validationType:"array",validations:[],isEditable:!0,options:[],onDelete:async e=>{(0,U.vW)({title:"Are you sure to delete the reason?",onDone:async()=>{await Ye.delete({payload:{id:e}}),a()}})},pluginConfiguration:{isCreatable:!0,isClearable:!0,isOptionRemovable:!0,removedText:"Delete option",deleteUrl:"/dischargeReason/delete"}},{name:"reason",label:"Reason",valueKey:"reason",value:"",type:"textarea",validationType:"string",validations:[],isEditable:!0,pluginConfiguration:{rows:3}}]};function fa(e){var a;let{toggleDeleteModel:t,state:l}=e;const[o,d]=(0,i.useState)(!1),{data:s,refetch:r}=(0,C.I)({queryKey:["/deschargeReason/list"],queryFn:async()=>(await Ye.list({})).data.map((e=>({id:e.id,label:e.title,value:e.title})))||[],keepPreviousData:!1,refetchOnWindowFocus:!1,enabled:Boolean(l.deleteModel)}),c=l.deleteModel,p=(0,i.useMemo)((()=>{let e=ha({cbDelete:r});return e=e.map((e=>("dischargeDate"===e.name&&(e.value=l.filters.visitDate?n()(l.filters.visitDate).toDate():n()().toDate()),"reasonType"===e.name&&(e.options=s),e))),e}),[s,null===(a=l.filters)||void 0===a?void 0:a.visitDate,r]),m=(0,i.useCallback)((async e=>{try{var a,i,l;const[n]=e.reasonType||[];if(!n)return(0,M.Q)("Please select a reason for discharge");e.reasonType=n.label;const o=null===(a=s.find((a=>a.value===e.reasonType)))||void 0===a?void 0:a.id;d(!0);const r={...e,patientId:null===c||void 0===c?void 0:c.id,providerId:null===c||void 0===c||null===(i=c.patientSlots[0])||void 0===i?void 0:i.providerId,slotId:null===c||void 0===c||null===(l=c.patientSlots[0])||void 0===l?void 0:l.id,discharge:!0,reasonId:o};await ra.dischargeUpdate({payload:r}),t(!0)}catch(n){console.error(n)}finally{d(!1)}}),[c,t,s]);return(0,L.jsx)(E.A,{header:"Discharge Patient",toggle:()=>t(),show:Boolean(l.deleteModel),body:(0,L.jsx)(L.Fragment,{children:l.deleteModel&&(0,L.jsx)(R.A,{className:"m-0",resetOnSubmit:!1,FormButtons:()=>(0,L.jsxs)("div",{className:"d-flex justify-content-end gap-10",children:[(0,L.jsx)(u.A,{variant:"secondary",onClick:()=>t(),children:"Cancel"}),(0,L.jsx)(u.A,{type:"submit",variant:"primary",disabled:o,children:o?"Discharging":"Discharge"})]}),dataFields:p,onSubmit:m})})})}function ga(e){var a;let{row:t,updatePatientVisited:l}=e;const[n,o]=(0,i.useState)((null===(a=t.patientSlots[0])||void 0===a?void 0:a.isVisited)||!1);(0,i.useEffect)((()=>{var e;t.patientSlots[0]&&o(null===(e=t.patientSlots[0])||void 0===e?void 0:e.isVisited)}),[t.patientSlots]);const d=(0,i.useCallback)((()=>{const e=!n;o(e),l({id:t.patientSlots[0].id,isVisited:e})}),[n,t.patientSlots,l]);return(0,L.jsx)("div",{onClick:e=>e.stopPropagation(),className:"d-flex h-100 w-100 custom-control custom-checkbox cursor-pointer justify-content-center align-items-center ".concat(n?"patient-visited":""),children:(0,L.jsxs)("div",{children:[(0,L.jsx)("input",{className:"custom-control-input",id:"select-all-".concat(t.id),name:"select-all-".concat(t.id),type:"checkbox",checked:n,onChange:()=>d()}),(0,L.jsx)("label",{className:"custom-control-label",htmlFor:"select-all-".concat(t.id)})]})})}const ya=function(e){let{indexValue:a,paymentCode:t=[],paymentOptions:l,onUpdate:n,isMulti:d=!1,row:s,apiRef:r}=e;const[c,u]=(0,i.useState)(!1),p=(0,i.useCallback)((async e=>{try{let a=[],i=[];if(d){const l=(null===t||void 0===t?void 0:t.map((e=>e.value)))||[],n=e.map((e=>e.value))||[];a=null===n||void 0===n?void 0:n.filter((e=>!l.includes(e))),i=null===l||void 0===l?void 0:l.filter((e=>!n.includes(e)))}else a=e.map((e=>e.value))||[];const l=async()=>{u(!0),await n({addedCode:a,removedCode:i}),(0,M.T)("Billing codes updated successfully"),u(!1)};a.length?l():(0,U.vW)({title:"Are you sure to change the billing code?",onDone:l})}catch(a){console.error(a),u(!1)}}),[t,n,d]),m=(0,i.useCallback)((e=>{e.stopPropagation();r.current.getExpandedDetailPanels().includes(s.id)&&r.current.toggleDetailPanel(s.id)}),[r,s.id]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsx)("div",{onClick:m,className:"py-2 w-100",children:(0,L.jsx)(o.Ay,{name:"billingCode",value:t,onChange:e=>p(d?e:[e]),options:l||[],className:"basic-multi-select issue-multi-select_user-dropdown input-border min-width-160",classNamePrefix:"billingcode_select",placeholder:"Billing code",menuPlacement:a>2?"top":"bottom",maxMenuHeight:200,isMulti:d,isDisabled:c,isLoading:c})})})};var xa=t(77016),ba=t(39591),Na=t(26384);const Da=[{field:"createdAt",sort:"desc"}],Ca=(e,a,t)=>{var i,l,n,o;const d=(0,_.D0)("filters");return{rows:[],page:1,total:0,pageSize:20,rowCountState:0,loading:!1,isHistory:!1,search:null!==d&&void 0!==d&&null!==(i=d.rounding)&&void 0!==i&&i.search?null===d||void 0===d?void 0:d.rounding.search:"",currSearch:"",roomNumber:null!==d&&void 0!==d&&null!==(l=d.rounding)&&void 0!==l&&l.roomNumber?null===d||void 0===d?void 0:d.rounding.roomNumber:null,filters:{facility:null!==d&&void 0!==d&&null!==(n=d.rounding)&&void 0!==n&&n.facility?null===d||void 0===d?void 0:d.rounding.facility:null,attendee:null!==e&&void 0!==e&&e.provider?e.provider:a?t:null!==d&&void 0!==d&&null!==(o=d.rounding)&&void 0!==o&&o.attendee?null===d||void 0===d?void 0:d.rounding.attendee:null,visitDate:(0,S.iU)(0).toLocaleString()},sortModel:Da,paymentOptions:[],primaryPaymentOptions:[],secondaryPaymentOptions:[],loadingExport:!1,loadingPaymentOptions:!1,facilityOptions:[],providerOptions:[],nurseOptions:[],attendingOptions:[],loadingOptions:!1,dictation:!1,todoModel:!1,pictureData:!1,selectedPatientId:null,addNewPatient:!1,selectionModel:[],transferModel:!1,noteModel:!1,orderRooms:{inputValue:"",value:[]},deleteModel:!1,row:null,updatedDetailData:null}},ja=["patientAssignFacility","patientPaymentCode","facilityInfo","patientAvailable"],wa=["roomNumber","lastName","visited","actions","profilePicture","facility","TypeofDischarge","reasonOfDischarge","insurance","attending","primaryBillCode","secondaryBillCode","admitDate"];function Aa(e){var a,t,l,d,O,k;let{isHistory:T=!1}=e;const F=(0,c.zy)(),E=(0,x.b)(),{user:R}=(0,w.d4)((e=>e.user)),{userDesignations:H}=(0,w.d4)((e=>e.chat)),{updateTable:W}=(0,w.d4)((e=>e.model)),K=(0,i.useMemo)((()=>F.state||{}),[F.state]),[B,G]=(0,i.useState)(Ca(K,null===R||void 0===R?void 0:R.isProvider)),V=(0,I.A)(B.search,1e3),q=(0,I.A)(B.roomNumber,1e3),[J,X]=(0,i.useState)(1);(0,i.useEffect)((()=>{(async()=>{G((e=>({...e,loadingOptions:!0})));try{const e={query:{providerId:!(0,ba.kz)(R)&&null!==R&&void 0!==R&&R.isProvider?R.id:void 0},options:{populate:["facilityProviderInfo","organizationInfo"]}},a=await ze.A.list({payload:e});G((e=>{var t;return{...e,loadingOptions:!1,facilityOptions:(null===a||void 0===a||null===(t=a.data)||void 0===t?void 0:t.map((e=>({id:e.id,value:e,label:e.name}))))||[]}}))}catch(e){console.error(e)}})(),(async()=>{try{G((e=>({...e,loadingPaymentOptions:!0})));const e=await Na.A.list({payload:{options:{populate:["primaryCode"]}}}),a=await Na.A.list({payload:{options:{populate:["secondaryCode"]}}});G((t=>({...t,loadingPaymentOptions:!1,primaryPaymentOptions:e.data.map((e=>({id:e.id,value:e.id,label:(0,L.jsx)(Sa,{item:e})}))),secondaryPaymentOptions:a.data.map((e=>({id:e.id,value:e.id,label:(0,L.jsx)(Sa,{item:e})})))})))}catch(e){(0,M.Q)("Could not fetch payment codes.",e)}})()}),[R]),(0,i.useEffect)((()=>{(async()=>{if(H){G((e=>({...e,loadingPaymentOptions:!0})));const e=await(0,Be.wE)(P.M.DESIGNATION_KEY.PROVIDER,"selectable"),a=await(0,Be.wE)(P.M.DESIGNATION_KEY.NURSE_PRACTITIONER),t=await(0,xa.F$)("",null===e||void 0===e?void 0:e.id,["providerInfoAssignfacility"]),i=await(0,xa.F$)("",null===a||void 0===a?void 0:a.id,["providerInfoAssignfacility"]),l=await He.A.list({payload:{options:{populate:["providerInfoAssignfacility"]}}});G((e=>({...e,loadingPaymentOptions:!1,attendingOptions:l.data.map((e=>({id:e.id,value:e,label:e.name}))),providerOptions:t.data.map((e=>({id:e.id,value:e,label:e.name}))),nurseOptions:i.data.map((e=>({id:e.id,value:e,label:e.name})))})))}})()}),[H]);const Q=(0,i.useCallback)((async e=>{var a,t,i,l,o,d,s,r,c,u,p,m,v,h,f,g,y,x,b,N,D,C,j;let{exportExcel:w=!1,config:A={}}=e;if(!Boolean(null===(a=B.filters)||void 0===a?void 0:a.visitDate))return null;if(!B.facilityOptions.length)return null;const M=await(0,Be.wE)(P.M.DESIGNATION_KEY.PROVIDER,"selectable"),I=await(0,Be.wE)(P.M.DESIGNATION_KEY.NURSE_PRACTITIONER,"selectable");if(null!==(t=B.filters)&&void 0!==t&&null!==(i=t.MD)&&void 0!==i&&i.value&&!M)return null;if(null!==(l=B.filters)&&void 0!==l&&null!==(o=l.NP)&&void 0!==o&&o.value&&!I)return null;let O=await(0,S.Qv)({keys:["firstName","lastName","phone","insurance"],value:V,options:{page:B.page,limit:B.pageSize,pagination:!w,populate:ja,sort:null!==(d=B.sortModel)&&void 0!==d&&d.length?B.sortModel.map((e=>[e.field,e.sort])):void 0},body:{[T?"dischargeDate":"start"]:{dateFrom:n()(B.filters.visitDate).format("YYYY-MM-DD"),dateTo:n()(B.filters.visitDate).format("YYYY-MM-DD")}},rest:{discharge:T,facilityId:(null===(s=B.filters)||void 0===s||null===(r=s.facility)||void 0===r||null===(c=r.value)||void 0===c?void 0:c.id)&&[null===(u=B.filters)||void 0===u||null===(p=u.facility)||void 0===p||null===(m=p.value)||void 0===m?void 0:m.id]||!(null===B||void 0===B||null===(v=B.facilityOptions)||void 0===v||!v.length)&&B.facilityOptions.map((e=>e.id))||void 0,roomNumber:q||void 0,attendeeId:null!==(h=B.filters)&&void 0!==h&&h.facility||null!==K&&void 0!==K&&K.provider?null===(f=B.filters)||void 0===f||null===(g=f.attendee)||void 0===g?void 0:g.value:void 0,MD:null!==(y=B.filters)&&void 0!==y&&y.MD?{id:null===(x=B.filters)||void 0===x||null===(b=x.MD)||void 0===b?void 0:b.value,designationId:null===M||void 0===M?void 0:M.id}:void 0,NP:null!==(N=B.filters)&&void 0!==N&&N.NP?{id:null===(D=B.filters)||void 0===D||null===(C=D.NP)||void 0===C?void 0:C.value,designationId:null===I||void 0===I?void 0:I.id}:void 0},isCount:!0,currSearch:B.currSearch});O.options.sort=[...O.options.sort||[],["patientSlots","start","desc"]],null!==(j=O.options.sort)&&void 0!==j&&j.length&&"roomNumber"===O.options.sort[0][0]&&O.options.sort[0].unshift("patientSlots"),w&&(O.exportExcel=w);const k=await Y.A.list({payload:O,config:A});{var F,E;let e=(0,_.D0)("filters");e.hasOwnProperty("rounding")||(e.rounding={}),e.rounding.search=V||null,e.rounding.facility=(null===(F=B.filters)||void 0===F?void 0:F.facility)||null,e.rounding.attendee=(null===(E=B.filters)||void 0===E?void 0:E.attendee)||null,(0,_.jO)("filters",e)}return G((e=>({...e,loading:!1,currSearch:B.currSearch,page:B.currSearch!==V?1:e.page}))),w?k:1===k.status?(k.data.rows=k.data.rows.map((e=>{var a,t;return null!==(a=e.patientSlots[0])&&void 0!==a&&a.roomNumber&&(e.roomNumber=null===(t=e.patientSlots[0])||void 0===t?void 0:t.roomNumber),e})),k.data.lastUpdated=n()().format(),k.data):null}),[null===B||void 0===B?void 0:B.filters,V,null===B||void 0===B?void 0:B.sortModel,B.currSearch,B.page,B.pageSize,T,null===K||void 0===K?void 0:K.provider,q,B.facilityOptions]),{data:$,refetch:Z,isFetching:ee}=(0,C.I)({queryKey:["/patient/list",B.page,B.pageSize,V,q,B.filters,B.sortModel,T,B.facilityOptions,W],queryFn:Q,keepPreviousData:!1,refetchOnWindowFocus:!1}),ae=(0,i.useCallback)((async(e,a)=>{a&&(e.paymentCode=e.addedCode[0]?e.addedCode[0]:void 0,["patientId","addedCode","removedCode"].forEach((a=>delete e[a]))),a?await ra.update({payload:e}):await sa.secondarypaymentcodeUpdate({payload:e}),Z()}),[Z]),te=(0,i.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];G((e=>({...e,deleteModel:!1,todoModel:!1,dictation:!1,noteModel:!1,pictureData:!1,row:null,addNewPatient:!1,update:!1}))),e&&Z()}),[Z]),ie=(0,i.useCallback)((async e=>{const a=await ra.update({payload:e});if(e.hasOwnProperty("slotIds"))return E.current.setSelectionModel([]),Z(),(0,M.T)("Slots marked as done successfully.");$.rows&&($.rows.find((a=>{var t;return(null===(t=a.patientSlots[0])||void 0===t?void 0:t.id)===e.id})).patientSlots[0].isVisited=a.data.isVisited)}),[$,Z,E]),le=(0,i.useCallback)(((e,a)=>{null!==$&&void 0!==$&&$.rows.find((a=>a.id===e))&&($.rows.find((a=>a.id===e)).profilePicture=a,X((e=>e+1)))}),[$]),ne=(0,i.useCallback)((async(e,a,t)=>{B.dictation&&(e={...e,fileName:e.fileName,mediaType:e.mediaType,mediaUrl:e.mediaUrl}),await(0,S.vX)({func:async(a,i)=>{try{const i=await Y.A.attachmentCreate({payload:{patientId:t,...e}});te(),G((e=>({...e,updatedDetailData:i.data}))),e.profilePicture&&le(t,e.mediaUrl),a(1)}catch(l){console.error(l),i(0)}},loading:"Creating File Data.",error:"Could not create File Data.",success:"File data created.",options:{id:"create-picture"}})}),[te,B.dictation,le]),oe=(0,i.useCallback)((async(e,a,t)=>{await(0,S.vX)({func:async(a,i)=>{try{await Y.A.taskCreate({payload:{patientId:t,...e}}),(0,S.$j)(G,{dictation:!1,pictureData:!1,todoModel:!1,noteModel:!1}),a(1)}catch(l){console.error(l),i(0)}},loading:"Creating Todo.",error:"Could not create todo.",success:"Todo created.",options:{id:"create-todo"}})}),[]),de=(0,i.useCallback)((async(e,a,t)=>{await(0,S.vX)({func:async(a,i)=>{try{await Y.A.noteCreate({payload:{patientId:t,...e}}),te(),a(1)}catch(l){console.error(l),i(0)}},loading:"Creating note.",error:"Could not create note.",success:"note created.",options:{id:"create-notes"}})}),[te]),se=(0,i.useCallback)((e=>{(0,U.vW)({title:'Are you sure about to delete the slot of the patient "'.concat(null===e||void 0===e?void 0:e.lastName,'"?'),onDone:async()=>{const[{id:a}]=null===e||void 0===e?void 0:e.patientSlots;await ra.delete({payload:{id:a}}),Z()}})}),[Z]),re=(0,i.useMemo)((()=>{let e={};const a=B.filters.visitDate?n()().format("MM/DD/YYYY")===n()(B.filters.visitDate).format("MM/DD/YYYY"):null,t=JSON.parse(localStorage.getItem("rounding-sheet-col-order"));J&&t&&wa.map(((a,i)=>{const l=t[a]||0===t[a]?t[a]:i;return e[a]=l,{name:a,order:l}})),localStorage.setItem("rounding-sheet-col-order",JSON.stringify(e));let i=[{field:"roomNumber",headerName:"Room",headerAlign:"center",align:"center",hide:T,renderCell:e=>{var a;let{row:t}=e;const i=null===t||void 0===t||null===(a=t.patientSlots[0])||void 0===a?void 0:a.roomNumber;return(0,L.jsx)(L.Fragment,{children:i||"-"})}},{field:"lastName",headerName:"Patient name",minWidth:180,headerAlign:"center",align:"center",flex:1,renderCell:e=>{var a,t;let{row:i}=e;const{firstName:l,lastName:n,middleName:o,patientSlots:d}=i,s=Pa(n,l,o),{name:r="-",image:c=""}=(null===(a=d[0])||void 0===a||null===(t=a.facilitySlotInfo)||void 0===t?void 0:t.info)||{};return(0,L.jsxs)("div",{className:"d-flex align-items-center gap-10",children:[s,(0,L.jsx)("img",{src:(0,S.bv)(c,"35x35",!1),alt:"",onClick:e=>{var a,t;e.stopPropagation(),(0,j.JD)({type:A.I.USER_IMAGE_DATA,payload:{name:r,image:c,id:null===(a=i.facilityInfo)||void 0===a||null===(t=a.info)||void 0===t?void 0:t.id,updateTable:"rounding-sheet",updateType:"organization",updateField:"image"}})}})]})}},{field:"visited",headerName:"Done",headerAlign:"center",align:"center",hide:T,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(ga,{row:a,updatePatientVisited:ie},B.filters.visitDate)}},{field:"actions",headerName:"Actions",headerAlign:"center",align:"center",sortable:!1,minWidth:T?180:r.Fr||!a?150:240,renderCell:e=>{let{row:a}=e;return(0,L.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"d-flex flex-wrap",children:[(0,L.jsx)(y.Ah,{Icon:p.A,color:"primary",fontSize:16,size:"sm",tooltip:"Todo",onClick:()=>(0,S.$j)(G,{todoModel:!0,selectedPatientId:a.id,row:a})}),(0,L.jsx)(y.Ah,{Icon:m.A,color:"primary",fontSize:16,size:"sm",tooltip:"Note",onClick:()=>(0,S.$j)(G,{noteModel:!0,selectedPatientId:a.id,row:a})}),(0,L.jsx)(y.Ah,{Icon:v.A,color:"primary",fontSize:16,size:"sm",tooltip:"Picture Data",onClick:()=>(0,S.$j)(G,{pictureData:!0,selectedPatientId:a.id})}),(0,L.jsx)(y.Ah,{Icon:h.A,color:"primary",fontSize:16,size:"sm",tooltip:"Recorder",onClick:()=>(0,S.$j)(G,{dictation:!0,selectedPatientId:a.id})}),(0,L.jsx)(y.or,{tooltip:"Edit",onClick:()=>(0,S.$j)(G,{update:a})}),!T&&(0,L.jsx)(y.Ah,{Icon:f.A,color:"secondary",fontSize:16,size:"sm",tooltip:"Discharge",onClick:()=>(0,S.$j)(G,{deleteModel:a})}),!T&&(0,L.jsx)(y.Jx,{tooltip:"Delete",onClick:()=>se(a)})]})}},{field:"profilePicture",headerName:"Profile",maxWidth:80,headerAlign:"center",align:"center",sortable:!1,renderCell:e=>{let{row:a}=e;const{firstName:t,lastName:i,middleName:l,profilePicture:n}=a,o=Pa(i,t,l);return(0,L.jsx)("div",{className:"d-flex",children:(0,L.jsx)("img",{src:(0,S.bv)(n,"35x35",!1),alt:"",onClick:e=>{e.stopPropagation(),(0,j.JD)({type:A.I.USER_IMAGE_DATA,payload:{id:a.id,name:o,image:n,updateType:"patient",updateTable:"rounding-sheet"}})}})})}},{field:"facility",headerName:"Facility",headerAlign:"left",align:"left",sortable:!1,renderCell:e=>{var a,t;let{row:i}=e;const l=(null===(a=i.patientSlots[0])||void 0===a||null===(t=a.facilitySlotInfo)||void 0===t?void 0:t.name)||null;return(0,L.jsx)(L.Fragment,{children:l||"-"})}},{field:"TypeofDischarge",headerName:"Discharge Type",minWidth:150,headerAlign:"left",align:"left",hide:!T,sortable:!1,renderCell:e=>{var a,t;let{row:i}=e;const l=(null===(a=i.patientSlots[0])||void 0===a||null===(t=a.patientDischarge)||void 0===t?void 0:t.reasonType)||null;return(0,L.jsx)(L.Fragment,{children:l||"-"})}},{field:"reasonOfDischarge",headerName:"Discharge Reason",minWidth:150,headerAlign:"left",align:"left",hide:!T,sortable:!1,renderCell:e=>{var a,t;let{row:i}=e;const l=(null===(a=i.patientSlots[0])||void 0===a||null===(t=a.patientDischarge)||void 0===t?void 0:t.reason)||null;return(0,L.jsx)(L.Fragment,{children:l||"-"})}},{field:"insurance",headerName:"Insurance",headerAlign:"left",align:"left",sortable:!1,renderCell:e=>{let{row:a}=e;return(0,L.jsx)(L.Fragment,{children:a.insurance?a.insurance:"-"})}},{field:"attending",headerName:"Attending",headerAlign:"left",align:"left",flex:1,sortable:!1,renderCell:e=>{var a,t,i;let{row:l}=e;const n=(null===(a=l.patientAssigns)||void 0===a||null===(t=a.find((e=>e.type===P.M.PROVIDER_TYPE.ATTENDEE)))||void 0===t||null===(i=t.usersPatient)||void 0===i?void 0:i.name)||null;return(0,L.jsx)(L.Fragment,{children:n||"-"})}},{field:"primaryBillCode",headerName:"Primary Billing Code",minWidth:250,flex:1,headerAlign:"center",align:"center",sortable:!1,renderCell:e=>{const{row:a}=e,t=e.api.getRowIndex(e.row.id),i=a.patientSlots[0]&&a.patientSlots[0].patientPaymentCode||null,l=i&&[{label:(0,L.jsxs)("div",{className:"d-flex gap-5 align-items-center",children:[(null===i||void 0===i?void 0:i.colorCode)&&(0,L.jsx)("div",{className:"color-dot",style:{background:null===i||void 0===i?void 0:i.colorCode,height:"12px",width:"12px"}}),null===i||void 0===i?void 0:i.code]}),value:null===i||void 0===i?void 0:i.id}]||null;return(0,L.jsx)(ya,{indexValue:t,paymentCode:l,row:a,apiRef:E,paymentOptions:B.primaryPaymentOptions,loading:B.loadingPaymentOptions,onUpdate:e=>ae({...e,patientId:a.id,id:a.patientSlots[0].id},!0)})}},{field:"secondaryBillCode",headerName:"Secondary Billing Code",minWidth:250,flex:1,headerAlign:"center",align:"center",sortable:!1,renderCell:e=>{var a;const{row:t}=e,i=e.api.getRowIndex(e.row.id),l=null===(a=t.patientSlots[0].secondaryPaymentCodes)||void 0===a?void 0:a.map((e=>{var a,t,i,l;return{label:(0,L.jsxs)("div",{className:"d-flex gap-5 align-items-center",children:[(null===e||void 0===e||null===(a=e.paymentCodeInfo)||void 0===a?void 0:a.colorCode)&&(0,L.jsx)("div",{className:"color-dot",style:{background:null===e||void 0===e||null===(t=e.paymentCodeInfo)||void 0===t?void 0:t.colorCode,height:"12px",width:"12px"}}),null===e||void 0===e||null===(i=e.paymentCodeInfo)||void 0===i?void 0:i.code]}),value:null===e||void 0===e||null===(l=e.paymentCodeInfo)||void 0===l?void 0:l.id}}));return(0,L.jsx)(ya,{indexValue:i,paymentCode:l,row:t,apiRef:E,loading:B.loadingPaymentOptions,paymentOptions:B.secondaryPaymentOptions,isMulti:!0,onUpdate:e=>ae({...e,patientId:t.id,slotId:t.patientSlots[0].id})})}},{field:"admitDate",headerName:"Admit Date",headerAlign:"center",align:"center",sortable:!1,renderCell:e=>{let{row:a}=e;const t=a.admitDate||null;return(0,L.jsx)(L.Fragment,{children:t?n()(t).format("MM/DD/YY"):"-"})}}].map((a=>({...a,order:e[a.field]})));return i.sort(((e,a)=>e.order>a.order?1:e.order<a.order?-1:0)),T||i.push({...b.f}),i.push({...N.a,hide:!0}),i}),[E,T,B.primaryPaymentOptions,B.secondaryPaymentOptions,B.filters.visitDate,B.loadingPaymentOptions,ae,ie,se,J]),ce=(0,i.useCallback)((function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&Z(),G((e=>({...e,transferModel:!e.transferModel})))}),[Z]),{providerOptions:ue,nurseOptions:pe,attendingOptions:ve}=(0,i.useMemo)((()=>{const e=B.filters.facility;let[a,t,i]=[B.providerOptions,B.nurseOptions,B.attendingOptions];return e&&(a=a.filter((a=>a.value.facilityAssigns.map((e=>e.facilityId)).includes(e.id))),t=t.filter((a=>a.value.facilityAssigns.map((e=>e.facilityId)).includes(e.id))),i=i.filter((a=>a.value.facilityAssigns.map((e=>e.facilityId)).includes(e.id)))),a=(0,_.Ow)(a.map((e=>({...e,value:e.id}))),"label"),t=(0,_.Ow)(t.map((e=>({...e,value:e.id}))),"label"),i=(0,_.Ow)(i.map((e=>({...e,value:e.id}))),"label"),{providerOptions:a,nurseOptions:t,attendingOptions:i}}),[B.providerOptions,B.nurseOptions,B.attendingOptions,B.filters.facility]),he=(0,i.useCallback)((async()=>{try{G((e=>({...e,loadingExport:!0})));const e={responseType:"arraybuffer",headers:{Accept:"application/vnd.ms-excel","Content-Type":"application/vnd.ms-excel"}},a=await Q({exportExcel:!0,config:e}),t=new Blob([a],{type:"application/vnd.ms-excel"});(0,_.Ru)(t,"Patient_Slot_".concat(n()(B.filters.visitDate).format("MM/DD/YY"),".xlsx")),G((e=>({...e,loadingExport:!1}))),(0,M.T)("File Downloaded Successfully")}catch(e){console.error(e)}}),[null===B||void 0===B||null===(a=B.filters)||void 0===a?void 0:a.visitDate,Q]),fe=(0,i.useCallback)((async()=>{if(B.selectionModel.length){const e=B.selectionModel.map((e=>{var a;const t=null===$||void 0===$?void 0:$.rows.find((a=>a.id===e));return t?null===(a=t.patientSlots[0])||void 0===a?void 0:a.id:null})).filter((e=>e));await ie({slotIds:e,isVisited:!0})}}),[B.selectionModel,ie,null===$||void 0===$?void 0:$.rows]),ge=(0,i.useCallback)((e=>{let a=JSON.parse(localStorage.getItem("rounding-sheet-col-order"));const{targetIndex:t,oldIndex:i,field:l}=e,n=(0,_.Dz)(a,t,i,l);localStorage.setItem("rounding-sheet-col-order",JSON.stringify(n)),X((e=>e+1))}),[]),ye=(0,i.useMemo)((()=>(0,L.jsx)(ke.A,{children:(0,L.jsx)(D.C,{apiRef:E,rows:(null===$||void 0===$?void 0:$.rows)||[],columns:re,loading:ee,autoHeight:!0,disableColumnFilter:!0,disableVirtualization:!0,getDetailPanelHeight:()=>"auto",getDetailPanelContent:e=>(0,L.jsx)(Fe,{visitDate:B.filters.visitDate,setPatientProfile:le,updatedDetailData:B.updatedDetailData,setMainState:G,params:e}),checkboxSelection:!T,onRowClick:e=>{E.current.setSelectionModel(B.selectionModel.includes(e.id)?B.selectionModel.filter((a=>a!==e.id)):B.selectionModel.push(e.id)),E.current.toggleDetailPanel(e.id)},onColumnOrderChange:ge,sortModel:B.sortModel,onSortModelChange:e=>G((a=>({...a,sortModel:e.length?e:a.sortModel}))),disableRowSelectionOnClick:!0,onSelectionModelChange:e=>G((a=>({...a,selectionModel:e}))),selectionModel:B.selectionModel,keepNonExistentRowsSelected:!0,components:{LoadingOverlay:g.A,Footer:()=>(0,L.jsx)(y.Hf,{isFetching:B.loading,lastUpdated:null===$||void 0===$?void 0:$.lastUpdated,pagination:{page:null===B||void 0===B?void 0:B.page,total:(null===$||void 0===$?void 0:$.count)||0,pageSize:null===B||void 0===B?void 0:B.pageSize},onPageChange:(e,a)=>{(0,S.$j)(G,{page:a})}})},density:"standard",getRowHeight:()=>"auto",getRowClassName:e=>{let{row:a}=e;return"min-height-60"},classes:{virtualScroller:"react-select-datagrid-MuiDataGrid-virtualScroller"}})})),[E,re,T,ge,$,B.loading,J,null===B||void 0===B?void 0:B.page,null===B||void 0===B?void 0:B.pageSize,B.selectionModel,B.sortModel,B.updatedDetailData,le,B.filters.visitDate]),{startIndex:xe,endIndex:be}=(0,i.useMemo)((()=>({startIndex:((null===B||void 0===B?void 0:B.page)-1)*B.pageSize+1,endIndex:Math.min((null===B||void 0===B?void 0:B.page)*B.pageSize,null===$||void 0===$?void 0:$.count)})),[null===$||void 0===$?void 0:$.count,null===B||void 0===B?void 0:B.page,B.pageSize]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"d-flex flex-wrap justify-content-between mb-2",children:[(0,L.jsxs)("div",{className:"d-flex gap-10 my-1",children:[(0,L.jsx)("div",{className:"accordion-button collapsed","data-bs-toggle":"collapse","data-bs-target":"#rounding-sheet-filters","aria-expanded":"false","aria-controls":"rounding-sheet-filters",children:(0,L.jsx)(u.A,{variant:"primary",children:"Filters"})}),(0,L.jsx)(u.A,{variant:"secondary",onClick:he,disabled:B.loadingExport,children:B.loadingExport?"Exporting...":"Export"})]}),!T&&(0,L.jsxs)("div",{className:"d-flex gap-10 my-1",children:[!!B.selectionModel.length&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(u.A,{variant:"primary",onClick:fe,children:"Mark as Done"}),(0,L.jsx)(u.A,{variant:"primary",onClick:ce,children:"Transfer"})]}),(0,L.jsx)(u.A,{variant:"primary",onClick:()=>(0,S.$j)(G,{addNewPatient:!0}),children:"Add Patient"})]})]}),(0,L.jsx)("div",{id:"rounding-sheet-filters",className:"accordion-collapse collapse ".concat(r.Fr?"":"show"),children:(0,L.jsx)("div",{className:"accordion-body mb-2",children:(0,L.jsxs)("div",{className:"date-task-filter d-flex flex-wrap align-items-center gap-5",children:[(0,L.jsxs)("div",{className:"d-flex px-0 align-items-center",title:"Visit date",children:[(0,L.jsx)("nobr",{htmlFor:"visitDate-filter",className:"fs-14 mb-0 mr-1",children:T?"Discharge Date:":"Visit Date:"}),(0,L.jsx)(s(),{id:"visitDate-filter",name:"visitDate",placeholderText:"Visit Date",className:"form-control search",selected:null!==(t=B.filters)&&void 0!==t&&t.visitDate?n()(null===(l=B.filters)||void 0===l?void 0:l.visitDate).toDate():null,value:null!==(d=B.filters)&&void 0!==d&&d.visitDate?n()(null===(O=B.filters)||void 0===O?void 0:O.visitDate).toDate():null,onChange:e=>G((a=>({...a,filters:{...a.filters,visitDate:e}}))),dateFormat:"MM/dd/yyyy"})]}),(0,L.jsx)("div",{className:"form-inline",children:(0,L.jsx)("div",{className:"input-group theme-border",children:(0,L.jsx)("input",{type:"text",className:"form-control search",placeholder:"Search patient",title:"Search User/Group",value:B.search||"",onChange:e=>G((a=>({...a,search:e.target.value})))})})}),(0,L.jsx)("div",{className:"form-inline",children:(0,L.jsx)("div",{className:"input-group theme-border",children:(0,L.jsx)("input",{type:"text",className:"form-control search",placeholder:"Room no.",title:"Search by room",value:B.roomNumber||"",onChange:e=>G((a=>({...a,roomNumber:e.target.value})))})})}),(0,L.jsx)("div",{className:"form-inline",children:(0,L.jsx)(o.Ay,{value:[B.filters.facility],isLoading:B.loadingOptions,classNamePrefix:"select",placeholder:"Select facility",className:"min-width-160",name:"facility",options:B.facilityOptions&&B.facilityOptions.length?B.facilityOptions:[],onChange:e=>G((a=>({...a,filters:{...a.filters,facility:e,attendee:e?a.filters.attendee:null}}))),menuPlacement:"bottom",isClearable:!0})}),(B.filters.facility||B.filters.attendee)&&(0,L.jsx)("div",{className:"form-inline",children:(0,L.jsx)(o.Ay,{name:"attendee",isLoading:B.loadingOptions,menuPlacement:"bottom",value:[B.filters.attendee],classNamePrefix:"select",placeholder:"Attendee Provider",options:ve&&ve.length?ve:[],onChange:e=>G((a=>({...a,filters:{...a.filters,attendee:e}}))),isClearable:!0,className:"min-width-160"})}),(0,L.jsx)("div",{className:"form-inline",children:(0,L.jsx)(o.Ay,{name:"hcmd_md",isLoading:B.loadingOptions,menuPlacement:"bottom",value:[B.filters.MD],classNamePrefix:"select",placeholder:"HCMD MD",options:ue&&ue.length?ue:[],onChange:e=>G((a=>({...a,filters:{...a.filters,MD:e}}))),isClearable:!0,className:"min-width-160"})}),(0,L.jsx)("div",{className:"form-inline",children:(0,L.jsx)(o.Ay,{name:"hcmd_np",isLoading:B.loadingOptions,menuPlacement:"bottom",value:[B.filters.NP],classNamePrefix:"select",placeholder:"HCMD NP",options:pe&&pe.length?pe:[],onChange:e=>G((a=>({...a,filters:{...a.filters,NP:e}}))),isClearable:!0,className:"min-width-160"})})]})})}),Boolean(xe&&be&&(null===$||void 0===$?void 0:$.count))&&(0,L.jsx)("p",{className:"d-flex justify-content-end",children:"".concat(xe,"-").concat(be," Rows of ").concat(null===$||void 0===$?void 0:$.count," Records")}),(0,L.jsx)("div",{className:"cstm-mui-datagrid stripe-table ".concat(null===$||void 0===$||null===(k=$.rows)||void 0===k||!k.length||B.loading?"loading":"not_loading react-select-datagrid"),style:{maxHeight:"88vh",width:"100%",flexGrow:1},children:ye}),(0,L.jsx)(me,{type:B.pictureData?"image":"audio",fieldName:B.dictation?"Dictation":"Picture Data",showModal:B.pictureData,onSubmit:ne,onCancel:te,patientId:B.selectedPatientId}),(0,L.jsx)(we,{type:"audio",fieldName:"Dictation",showModal:Boolean(B.dictation),visitDate:B.filters.visitDate,onSubmit:ne,onCancel:te,patientId:B.selectedPatientId}),(0,L.jsx)(Ne,{fieldName:"Todo",showModal:Boolean(B.todoModel),onSubmit:oe,onCancel:te,patientId:B.selectedPatientId,rowData:B.row}),(0,L.jsx)(z,{fieldName:"Note",showModal:Boolean(B.noteModel),onSubmit:de,onCancel:te,patientId:B.selectedPatientId,rowData:B.row}),(B.addNewPatient||B.update)&&(0,L.jsx)(pa,{onSubmit:Z,updateData:B.update,onCancel:te}),(0,L.jsx)(va,{state:B,toggleTransferModel:ce,data:(null===$||void 0===$?void 0:$.rows)||[],providers:B.providerOptions}),(0,L.jsx)(fa,{state:B,toggleDeleteModel:te})]})}const Sa=e=>{let{item:a}=e;return(0,L.jsxs)("div",{className:"d-flex gap-10 align-items-center",children:[a.colorCode&&(0,L.jsx)("div",{className:"color-dot",style:{background:a.colorCode,height:"12px",width:"12px"}}),a.code]})},Pa=(e,a,t)=>[e,a,t].filter((e=>e)).join(", ")}}]);
//# sourceMappingURL=20.1092f3f1.chunk.js.map